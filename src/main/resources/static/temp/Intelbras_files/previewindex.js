function loadCssFile(a){new Asset.css(a,{id:"css_"+a})}function loadAllCssFile(){var a=parent.remoteParams;"object"!=$type(a)&&(a={});var b="";"remote"==a.from&&(b="?"+a.ALL);for(var c=["/css/reset.css","/css/ui.css","/css/previewindex.css","/css/fn.css","/css/skin.css","/css/oem.css"],d=0;d<c.length;d++)loadCssFile(c[d]+b,function(){})}function loginOCX(a,b,c,d,e,f,g,h){if(!parent.hasPlugin)return 1;ocx=parent.g_ocx;var i=0,j=location.hostname,k=a,l=b,m=getTcpPort();if(g_netType=c,ocx.SetModuleMode(0==g_netType?1:10),i=void 0==e?ocx&&ocx.LoginDeviceEx(j,m,k,l,d):ocx&&ocx.LoginDeviceEx("127.0.0.1",h-0,k,l,19),0==i)return Cookie.write("DHloginType",d,{duration:0,path:"/"}),getdjl(),g_LoginId=ocx.GetLoginID(),parent.showTime(),ocx.SetDeviceMode(0,settings.talktype-0),1;switch(i){case 1:alert(tl("conf.LoginErrorNo-1"));break;case 2:alert(tl("conf.LoginErrorNo-2"));break;case 3:alert(tl("com_msg.Login failure!"));break;case 4:alert(tl("conf.LoginErrorNo-4"));break;case 5:alert(tl("conf.LoginErrorNo-5"));break;case 6:alert(tl("conf.LoginErrorNo-6"));break;case 7:alert(tl("conf.LoginErrorNo-7"));break;case 8:alert(tl("com_msg.Login failure!"));break;case 9:alert(tl("com_msg.Login failure!"));break;case 10:alert(tl("opr_ocx.the number of connection is maximal.request is refused!"));break;default:alert(i>100&&500>i?tl("ugm_msg.account_failed_tip").replace("%d",i-100):i>1e3?tl("ugm_msg.account_locked_tip").replace("%d",Math.ceil((i-1e3)/60)):tl("com_msg.Login failure!"))}return 0}function getJsonlang(){curLang=getLangConf()}function refreshChInfo(a){void 0==a&&(a=!1);try{var b=ConfigManager.instance(),c=LogicDeviceManager.instance();c.getCameraAll(function(a,b){b.result&&b.params&&b.params.camera&&(jsonRemoteDevice=b.params.camera)},!1);var d=function(b){jsonChannels=JSON.decode(b).params.table||[];var c=[];if(g_addDevCh=getAddDevChannel(jsonRemoteDevice),"NVR"===parent.g_deviceType&&(g_addDevCh.each(function(a){c.push($defined(jsonChannels[a])?{Name:jsonChannels[a].Name,chNO:a}:{Name:jsonRemoteDevice[a].UniqueChannel,chNO:a})}),jsonChannels=$unlink(c)),!a)for(var d=$$("#channel_in .pre-channel-name"),e=$$("#channel_in a.pre-channel-item"),f=0;f<jsonChannels.length&&f<d.length;f++)d[f].setProperty("text",reps(jsonChannels[f].Name)),e[f].setProperty("title",reps(jsonChannels[f].Name))};"NVR"!==parent.g_deviceType&&0==REMOTE_CHANNELS?b.getConfig("ChannelTitle",d,!a):b.getConfig("VideoIn",d,!a)}catch(e){}}function showAlarmCh(){for(var a="",b=0;g_almChNO>b;b++)a+='<a href="javascript:;" class="ui-channel-item" id="am1'+b+'" onclick="changeAlarm('+b+')">'+(b+1)+"</a>";$("alarmChn").innerHTML=a}function changeAlarm(a){if(!parent.checkAuthority("Alarm"))return void alert(tl("com_msg.No Right"));var b=ConfigManager.instance(),c=function(a){var b=(JSON.decode(a).result,ConfigManager.instance());b.getConfig("AlarmOut",putAlarm)};b.getConfig("AlarmOut",function(a){JSON.decode(a).result&&(jsonAlarmout=JSON.decode(a).params.table)},!1),$("am1"+a).hasClass("ui-channel-item-current")?$("am1"+a).hasClass("ui-channel-item-current")&&($("am1"+a).removeClass("ui-channel-item-current"),jsonAlarmout[a].Mode=0):($("am1"+a).addClass("ui-channel-item-current"),jsonAlarmout[a].Mode=1),b.setConfig("AlarmOut",jsonAlarmout,c)}function getRecordState(){var a=ConfigManager.instance();a.getConfig("RecordMode",function(a){if(JSON.decode(a).result){jsonRecMode=getTable(a);for(var b=[],c=0;CHANNEL_NUMBER-REMOTE_CHANNELS>c;c++)b.push(c);for(var c=0;c<g_addDevCh.length;c++)b.push(g_addDevCh[c]);for(var c=0;c<b.length;c++)if(1!==jsonRecMode[b[c]].Mode)return void $("rc1all").removeClass("ui-button-current");b.length>0&&$("rc1all").addClass("ui-button-current")}},!0)}function urgentRecord(){if(!parent.checkAuthority("Record"))return void alert(tl("com_msg.No Right"));var a=ConfigManager.instance();a.getConfig("RecordMode",putRecord,!1);var b=$("rc1all").className,c=function(a){var c=JSON.decode(a).result;c||($("rc1all").className=b)};if($("rc1all").hasClass("ui-button-current")){if($("rc1all").hasClass("ui-button-current")){$("rc1all").removeClass("ui-button-current");for(var d=0;CHANNEL_NUMBER>d;d++)jsonRecMode[d].Mode=0}}else{$("rc1all").addClass("ui-button-current");for(var d=0;CHANNEL_NUMBER>d;d++)jsonRecMode[d].Mode=1;if(1==maxStreams)for(var d=0;CHANNEL_NUMBER>d;d++)jsonRecMode[d].ModeExtra1=2}a.setConfig("RecordMode",jsonRecMode,c)}function refreshAlarmChn(){var a=ConfigManager.instance();a.getConfig("AlarmOut",putAlarm)}function iniocx(){ocx=$("ocx")}function reInitPlugin(){$("prew_video_control").style.display="";var a=ConfigManager.instance();if(a.getConfig("General",function(a){if(JSON.decode(a).result){var b=getTable(a),c=CHANNEL_NUMBER-REMOTE_CHANNELS,d=multiPreview.isMutiPreviewShow(),e=g_deviceType.contains("DVR")?"DVR":"NVR";ocx.SetInitParams('{"MachineName":"'+b.MachineName+'","LocalChannelsNumber":'+c+',"IsMultiPreviewShow":'+d+',"IsPlayBackCanSnapshot":'+parent.Ability.isSupportPlaySnapshot+',"MachineType":"'+e+'"}')}}),1==parent.g_netType){initLanVideo();for(var b=$$("#channel_in .pre-channel-name"),c=$$("#channel_in a.pre-channel-item"),d=0;d<jsonChannels.length&&d<b.length;d++)b[d].setProperty("text",reps(jsonChannels[d].Name)),c[d].setProperty("title",reps(jsonChannels[d].Name));gch_sel=0,gst_sel=1,$("p_openAll").style.display="none",$("p_local").style.display="none";for(var d=0;CHANNEL_NUMBER>d;d++)$("chl"+d)&&(Sys.ie?$("chl"+d).disabled=!0:$("chl"+d).removeProperties("onclick","onmouseover","onmouseout"))}}function pageInit(){if(CHANNEL_NUMBER=parent.Ability.CHANNEL_NUMBER,REMOTE_CHANNELS=parent.Ability.REMOTE_CHANNELS,multiPreview=multiPreview||new MultiPreview(parent.g_deviceType,parent.Ability.previewMode),parent.hasPlugin||($("prew_video_control").style.display="none"),g_openNum=0,getProductDefinition(),attachInputLimit(),getRecordCap(),chkdev(),refreshChInfo(!0),getRecordState(),initAndBindVideoScreen(),multiPreview.initPreview(),1==parent.g_netType){for(var a=$$("#channel_in .pre-channel-name"),b=$$("#channel_in a.pre-channel-item"),c=0;c<jsonChannels.length&&c<a.length;c++)a[c].setProperty("text",reps(jsonChannels[c].Name)),b[c].setProperty("title",reps(jsonChannels[c].Name));gch_sel=0,gst_sel=1}getChannels(),addWheelEvent();var d=ConfigManager.instance();d.getConfig("AlarmOut",putAlarm);var e=multiPreview.showAndGetMultiPreview();if(parent.hasPlugin&&d.getConfig("General",function(a){if(JSON.decode(a).result){var b=getTable(a),c=CHANNEL_NUMBER-REMOTE_CHANNELS,d=parent.g_deviceType.contains("DVR")?"DVR":"NVR";ocx.SetInitParams('{"MachineName":"'+b.MachineName+'","LocalChannelsNumber":'+c+',"IsMultiPreviewShow":'+e+',"IsPlayBackCanSnapshot":'+parent.Ability.isSupportPlaySnapshot+',"MachineType":"'+d+'"}')}}),1==parent.g_netType){$("p_openAll").style.display="none",$("p_local").style.display="none";for(var c=0;CHANNEL_NUMBER>c;c++)$("chl"+c)&&(Sys.ie?$("chl"+c).disabled=!0:$("chl"+c).removeProperties("onclick","onmouseover","onmouseout"))}else $("p_openAll").style.display="",$("p_local").style.display="";g_ptzEnable||0!=REMOTE_CHANNELS||($("pre_righter").style.display="none"),1==g_netType&&initLanVideo();var f=function(a){if(JSON.decode(a).result){var b=JSON.decode(a).params.info;"HI3520A"!=b&&"HI3521"!=b&&"HI3531"!=b||24!=CHANNEL_NUMBER&&32!=CHANNEL_NUMBER||(g_is5xLFSL=!0)}},g=new MagicBox;g.getProcessInfo(f),"NVR"===parent.g_deviceType&&$("p_openAll").setStyle("display","none"),0==parent.Ability.ALARM_OUT_NUMBER&&($("taba2").style.display="none"),parent.g_deviceSubType.contains("EVS")&&($("p_talk").style.display="none"),parent.Ability.displayMode||($("screen_show").style.display="none",$("openPreview").setStyle("width",125))}function initLanVideo(){ocx.SetWinBindedChannel(1,0,0,0),ocx.ConnectWanMultiRealVideo(0,0),cimaexpara||(cimaexpara=new ImageExPara),cimaexpara.channelChange(0),wanVideoNum=1,wanStartChannel=0}function resumeEQbuttonStates(a){cimaexpara||(cimaexpara=new ImageExPara),cimaexpara.channelChange(a)}function putAlarm(a){if(null!=$("alarmChn")&&JSON.decode(a).result){var b=getTable(a);if(jsonAlarmout=b,null===b||0===b)return void("none"===$("taba1").style.display?$("taba").style.display="none":($("taba2").style.display="none",$("taba1").style.width="140px"));g_almChNO=b.length,showAlarmCh(),b.each(function(a,b){0==a.Mode?$("am1"+b).hasClass("ui-channel-item-current")&&$("am1"+b).removeClass("ui-channel-item-current"):1==a.Mode&&($("am1"+b).hasClass("ui-channel-item-current")||$("am1"+b).addClass("ui-channel-item-current"))})}}function putRecord(a){if(null!=$("alarmChn")&&JSON.decode(a).result){var b=getTable(a);jsonRecMode=b}}function getTcpPort(){return capTcpPort}function lo(){doLogout(),Sys.ie?(ocx.LogoutDevice(),loeft()):(getsetting(),$("channel_in").empty())}function loeft(){getsetting(),closemu(),closemnudj(),1==gdj&&(gdj=0,$("xdj_label").innerText=tl("com_str.start talk")),1==gopenall&&(gopenall=0,$("xac_label").innerText=tl("com_str.openall")),ocx.CloseLocalPlay(),$("channel_in").empty()}function ca(a,b){if(parent.hasPlugin){if(void 0==b&&(b=a),0==playInfoRec[b].state&&g_is5xLFSL&&Sys.ie&&g_openNum>=16)return void alert(tl("com_msg.maxMonitorNum")+"16");if(1==multiPreview.multiPreviewState.state&&multiPreview.multiPreviewState.windowID==gwid)return ocx.DisConnectRealVideo(a)&&(multiPreview.multiPreviewState.state=0),void ca(a,b);if(0==playInfoRec[b].state){var c=parent.jsonWebCaps.overlayColor;if(c&&c.preOverlay){for(var d=getVideoWidgetConfig(a),e={Protocol:"Overlay",Params:{channel:a,number:4,overlaywindows:[]}},f=0;f<d.length;f++){var g={position:d[f].Rect,color:d[f].BackColor,enable:d[f].PreviewBlend};e.Params.overlaywindows.push(g)}ocx.ProtocolPluginWithWebCall(JSON.encode(e))}ocx.ConnectRealVideo(a,1)&&(playInfoRec[b].state=1,openStreamVideo(a,1))}else(1==playInfoRec[b].state||2==playInfoRec[b].state)&&(ocx.DisConnectRealVideo(a)||(playInfoRec[b].state=0,closeStreamVideo(a)))}}function getVideoWidgetConfig(a){var b=ConfigManager.instance(),c=[];return b.getConfigEx("VideoWidget",a,function(a){if(JSON.decode(a).result){var b=JSON.decode(a).params.table;c=b.Covers}},!1),c}function startLocalPlay(){parent.hasPlugin&&ocx.QuickOperation(0)}function startTalk(){if(parent.hasPlugin){var a=$("xdj"),b=$("xdj_label"),c=tl("com_str.stop talk"),d=tl("com_str.start talk"),e=!1;if(0==gdj){var f=ocx.ControlTalking(1);1==f?(gdj=1,b.innerText=c,b.setProperty("text",c),a.addClass("ui-button-current"),e=!0):0==f?alert(tl("opr_ocx.Close Channel Audio first!")):-1==f?alert(tl("opr_ocx.micSource")):-2==f?alert(tl("opr_ocx.Stop talking first!")):85==f&&alert(tl("com_msg.netovertime"))}else ocx.ControlTalking(0)&&(gdj=0,b.innerText=d,b.setProperty("text",d),a.removeClass("ui-button-current"),e=!0);return e}}function sldtopos(a,b){a.set(b)}function sldtoposEx(a){gsld.set(a)}function txreset(a){setcolorsv(1,a),setcolorsv(2,a),setcolorsv(3,a),setcolorsv(4,a),sldtopos(gslda,a),sldtopos(gsldb,a),sldtopos(gsldc,a),sldtopos(gsldd,a),setcolors(),-1!=gch_sel&&CHANNEL_NUMBER-REMOTE_CHANNELS>gch_sel&&(1==multiPreview.multiPreviewState.state&&gwid!=multiPreview.multiPreviewState.windowID||0==multiPreview.multiPreviewState.state)&&cimaexpara&&cimaexpara.defaultSetPosition()}function getcolors(){var a="";a=ocx.GetColor();var b=new Array;""!=a&&(b=a.split(",")),sldtopos(gslda,parseInt(b[0])),sldtopos(gsldb,parseInt(b[1])),sldtopos(gsldc,parseInt(b[2])),sldtopos(gsldd,parseInt(b[3])),setcolorsv(1,parseInt(b[0])),setcolorsv(2,parseInt(b[1])),setcolorsv(3,parseInt(b[2])),setcolorsv(4,parseInt(b[3]))}function setcolorsv(a,b){switch(a){case 1:gca=b,$("ska").title=b;break;case 2:gcb=b,$("skb").title=b;break;case 3:gcc=b,$("skc").title=b;break;case 4:gcd=b,$("skd").title=b;break;case 5:$("eqm").title=b-0}}function setcolors(){parent.hasPlugin&&ocx.SetColor(0,gca,gcb,gcc,gcd)}function showStrmStatus(a){var b=playInfoRec[a].state;1==b?($("dot0").style.visibility="visible",$("dot1").style.visibility="hidden"):2==b?($("dot0").style.visibility="hidden",$("dot1").style.visibility="visible"):($("dot0").style.visibility="hidden",$("dot1").style.visibility="hidden")}function showmu(a,b,c){void 0==c&&(c=b);var d=$("prew_cmu"),e=parent.jsonWebCaps.previewChShowMenu,f="click"==e||!e;if(f&&"none"!==d.getStyle("display")&&a.id==d.getPrevious().id)d.setStyle("display","none");else if(d.setStyle("display","block"),d.setProperty("chnlNo",b),d.injectAfter(a),playInfoRec[c].state>0){var g=playInfoRec[c].state-1,h=$$("span[id^=prew_dot]");h.setStyle("visibility","hidden"),h[g].setStyle("visibility","visible")}else $$("span[id^=prew_dot]").setStyle("visibility","hidden")}function onmu(a){var b=$("cmu").getProperty("ch");ocx.ConnectRealVideo(parseInt(b),a),closemu()}function closemu(){gcid=-1}function tl(a){return jsonLang&&jsonLang[a]?jsonLang[a].trim():a}function chkdev(){var a="";if(a="<li><a href='javascript:;'  class='cdj1' onclick='onmnuopen(this,1)'>"+tl("opr_play.MainStream")+"</a></li>",1==g_maxExtra)a=a+"<li><a href='javascript:;'  class='cdj1' onclick='onmnuopen(this,2)'>"+tl("opr_play.Assistant_1")+"</a></li>";else for(var b=0;g_maxExtra>b;b++)a=a+"<li><a href='javascript:;'  class='cdj1' onclick='onmnuopen(this,2)'>"+tl("opr_play.Assistant_1")+(b+1)+"</a></li>";$("mnuopenl").innerHTML=a,Sys.ie}function savesetting(){parent.savesetting()}function getsetting(){parent.getsetting()}function reps(a){var b=/"/g,c=/'/g,d=/</g,e=/>/g,f=/&/g,g=a.replace(f,"&amp;");return g=g.replace(b,"&quot;"),g=g.replace(c,"&acute;"),g=g.replace(d,"&lt;"),g=g.replace(e,"&gt;")}function showmnudj(){0==gfmnudj?(closemnuopen(),multiPreview.closemnuyl(),gfmnudj=1,$("mnudj").style.display=""):closemnudj()}function closemnudj(){gfmnudj=0,$("mnudj").style.display="none"}function onmnudj(a,b){parent.hasPlugin&&(null!=gomnudj&&(gomnudj.removeClass(gomnudj.className),gomnudj.addClass("cdj1")),settings.talktype=a.id.replace(/[^\d]/g,""),gomnudj=$(a),gomnudj.removeClass(gomnudj.className),gomnudj.addClass("cdj2"),1==gdj&&ocx.ControlTalking(0)&&(gdj=0),"0"==b&&(b="1"),ocx.SetDeviceMode(0,b),startTalk()&&savesetting(),closemnudj(),gomnudj.removeClass("cdj2"),gomnudj.addClass("cdj1"))}function showmnuopen(){0==gfmnuopen?(closemnudj(),multiPreview.closemnuyl(),gfmnuopen=1,$("mnuopen").style.display=""):closemnuopen()}function closemnuopen(){gfmnuopen=0,$("mnuopen").style.display="none"}function onmnuopen(a,b){if(parent.hasPlugin&&(settings.openall!=b||1!=gopenall||!chkPlayInfo(playInfoRec))){if(g_is5xLFSL&&Sys.ie)return ocx.DisConnectAllChannel(),void ocx.ConnectChannels(0,16,b);null!=gomnuopen&&(gomnuopen.removeClass(gomnuopen.className),gomnuopen.addClass("cdj1")),gomnuopen=$(a),gomnuopen.removeClass(gomnuopen.className),gomnuopen.addClass("cdj2"),closemnuopen(),gomnuopen.removeClass("cdj2"),gomnuopen.addClass("cdj1"),settings.openall=b,savesetting(),gopenall=0,openall($("xac"),tl("com_str.closeall"),tl("com_str.openall"))}}function showEncode(a){if(1!=g_netType){g_flag_over=!0;$$(".pre-channel-item").removeClass("pre-channel-item-current"),$$(".pre-channel-encode-box").setStyle("display","none"),$("enc"+a).setStyle("display","block"),calcBlkHeight()}}function closeEncode(){for(var a=0;CHANNEL_NUMBER>a;a++)$("enc"+a).style.display="none",0==playInfoRec[a].state&&$("chl"+a).removeClass("pre-channel-item-current");calcBlkHeight()}function openTargetVideo(a,b){var c=$(a).getParents("ul"),d=parseInt(c.getProperty("chnlNo")[0]),e=d;if("NVR"===parent.g_deviceType){var f=c.getPrevious("div[id^=item]")[0];e=f.id.replaceToNum()}openVideo(b,d,e)}function openVideo(a,b,c){return parent.hasPlugin?(void 0==c&&(c=b),g_is5xLFSL&&Sys.ie&&g_openNum>=16&&0==playInfoRec[c].state?void alert(tl("com_msg.maxMonitorNum")+"16"):void((playInfoRec[c].windowID!=gwid||playInfoRec[c].state!=a)&&(ocx.DisConnectRealVideo(b),ocx.ConnectRealVideo(b,a)?openStreamVideo(b,a):closeStreamVideo(b)))):void 0}function closeStreamVideo(a){var b="pre_channel_iconYellow"+parent.g_deviceType;$("strm_tip"+a)&&(void 0!==a?($$("#chl"+a+" span.pre-channel-icon").removeClass(b),$("strm_tip"+a).setProperty("text","")):($$("prew_channel_in a[id^=chl] span.pre-channel-icon").removeClass(b),$$("span[id^=strm_tip]").setProperty("text","")))}function openStreamVideo(a,b){var c="pre_channel_iconYellow"+parent.g_deviceType;$$("#chl"+a+" span.pre-channel-icon").addClass(c),$("strm_tip"+a).setProperty("text",g_strmTips[b]);var d=$$("span[id^=prew_dot]");d.setStyle("visibility","hidden"),d[b-1].setStyle("visibility","visible");var e=$("prew_cmu");("over"!=parent.jsonWebCaps.previewChShowMenu||"absolute"==e.getStyle("position"))&&e.setStyle("display","none")}function refreshChNameList(){refreshChInfo(!0),getChannels()}function getChannels(){for(var a,b=[],c=CHANNEL_NUMBER-REMOTE_CHANNELS,d="<div class='pre-channel-item' id='item%s'><a id='chl%s'class='pre-channel-item' href='javascript:' title='%s'>                            <span class='pre-channel-icon'>                                <span class='J_channel_font' style='float:right;text-align:center;'>%s</span>                             </span>                        <span class='pre-channel-name'>%s</span>                         <span id='strm_tip%s' class='pre-channel-tip'></span>                        </a>                        <a id='prew_mu%s' class='pre_channel_downicon' href='javascript:' style='display: none;'></a></div>",e=0;e<jsonChannels.length;e++){playInfoRec[e]={},playInfoRec[e].state=0,playInfoRec[e].windowID=-1,a=e>=c?jsonChannels[e].RemoteName||jsonChannels[e].Name||"":jsonChannels[e].Name||"";var f=reps(a),g=void 0===jsonChannels[e].chNO?e:jsonChannels[e].chNO;playInfoRec[e].chnlNo=g,b.push(d.sprintf(e,g,f,g+1,f,g,g))}var h=$("channel_in"),i=h.getElements("ul"),j=i[0]||$("prew_cmu");if(j){j.setStyle("display","none"),$("channel_mid").adopt(j);var k=[];if(0==j.getChildren("li").length){if(j.firstChild)var l=j.firstChild.nodeValue;else var l="";for(var e=0;g_maxExtra>=e;e++){var m=g_maxExtra>1&&e>1?tl("opr_play.Assistant_1")+e:tl("opr_play.Assistant_1");0===e&&(m=tl("opr_play.MainStream")),k.push(l.sprintf(e+1,e,e,m))}j.innerHTML=k.join("")}}if(h.innerHTML=b.join(""),"NVR"!==parent.g_deviceType){var n=$$("#channel_in span.pre-channel-icon");n.addClass("pre_channel_iconDVR"),$$("#channel_in span.J_channel_font").setStyle("display","none")}0===parent.g_netType&&($$("#channel_in div.pre-channel-item").addEvents({mouseover:function(){arguments[0].stopPropagation()||window.event.preventDefault();var a=this,b=this.getChildren("a.pre_channel_downicon"),c=a.id.replaceToNum(),d=c;"NVR"===parent.g_deviceType&&(d=a.id.replaceToNum()),"over"==parent.jsonWebCaps.previewChShowMenu?($$("#channel_in  .pre-channel-item-current").removeClass("pre-channel-item-current"),this.addClass("pre-channel-item-current"),showmu($(this),c,d)):(b.setStyle("display",""),b.addEvent("click",function(){showmu(this.getParent("div.pre-channel-item"),c,d)}))},mouseout:function(){arguments[0].stopPropagation()||window.event.preventDefault();var a=this.getChildren("a.pre_channel_downicon");a.setStyle("display","none"),a.removeEvents("click")}}),$("pre_left_channel").addEvent("mouseout",function(){var a=arguments[0].page.x||window.event.clientX,b=arguments[0].page.y||window.event.clientY;(a>=$(this).getSize().x||b>=$(this).getSize().y)&&$("prew_cmu").setStyle("display","none").getPrevious().removeClass("pre-channel-item-current")}),$$("a[id^=chl]").addEvent("click",function(){var a=this.id.replaceToNum();if("NVR"===parent.g_deviceType){var b=this.getParent().id.replaceToNum();ca(a,b)}else ca(a)})),$("channel_in").getStyle("height").toInt()<=480?($("scrollbar").setStyle("display","none"),$("block5").setStyle("display","none")):($("scrollbar").setStyle("display",""),$("block5").setStyle("display",""),calcBlkHeight())}function channelMouseOut(a){1!=g_netType&&(g_flag_over=!1,calcBlkHeight(),setTimeout(function(){g_flag_over||($("enc"+a).style.display="none",calcBlkHeight(),0==playInfoRec[a].state?$("chl"+a).className="pre-channel-item":$("chl"+a).addClass("pre-channel-yellow"))},5))}function streamMouseOver(a){$("chl"+a).addClass("pre-channel-item-current"),g_flag_over=!0,calcBlkHeight()}function streamMouseOut(a){g_flag_over=!1,calcBlkHeight(),setTimeout(function(){g_flag_over||($("enc"+a).style.display="none",$$(".pre-channel-item").removeClass("pre-channel-item-current"),calcBlkHeight(),0==playInfoRec[a].state?$("chl"+a).className="pre-channel-item":$("chl"+a).addClass("pre-channel-yellow"))},5)}function calcBlkHeight(){g_barHeight=$("scrollbar").offsetHeight.toInt();var a=parseInt($("block5").style.top);a=isNaN(a)?0:a,g_blkHeight=$("scrollbar").offsetHeight*($("scrollbar").offsetHeight/($("channel_in").offsetHeight.toInt()+50)),$("block5").style.height=g_blkHeight+"px",a+g_blkHeight>g_barHeight&&($("block5").style.top="0px"),g_conHeight=$("channel_in").offsetHeight.toInt()+50,$("block5").style.top="0px",$("channel_in").setStyle("marginTop","0px")}function addWheelEvent(){$("channel_in").getStyle("height").toInt()<=480?($("scrollbar").setStyle("display","none"),$("block5").setStyle("display","none")):calcBlkHeight(),function(){function a(a){if(f||e){d=e.style.top.toInt(),d=isNaN(d)?0:d,moveY=a.page.y-c,d=moveY+d,0>d?d=0:d>g_barHeight-g_blkHeight&&(d=g_barHeight-g_blkHeight),e.style.top=d+"px",c=a.page.y;var b=d/(g_barHeight-g_blkHeight)*(g_conHeight-g_barHeight);$("channel_in").setStyle("marginTop",-b)}}function b(){f=!1,$(document).removeEvent("mousemove",a),$(document).removeEvent("mouseup",b),$(document.body).removeAttribute("onselectstart"),$(document.body).removeAttribute("unselectable")}var c,d,e,f=!1;$("block5").getParent().style.position="relative",$("block5").addEvent("mousedown",function(d){d.rightClick||(f=!0,c=d.page.y,e=this,$(document).addEvent("mousemove",a),$(document).addEvent("mouseup",b),$(document.body).setAttribute("onselectstart","javascript:return false;"),$(document.body).setAttribute("unselectable","on"))})}(),$("channel_in").addEventAll("mousewheel",onChannelWheel),$("scrollbar").addEventAll("mousewheel",onChannelWheel),$("block5").addEventAll("mousewheel",onChannelWheel)}function isInRange(a){return a>g_barHeight-g_blkHeight||0>a?!1:!0}function onChannelWheel(a){var b=0;b=a.detail?a.detail/3:-a.wheelDelta/120;var c=$("block5").style.top.toInt();isInRange(c+50*(g_barHeight-g_blkHeight)*b/(g_conHeight-g_barHeight))?($("block5").setStyle("top",c+50*(g_barHeight-g_blkHeight)*b/(g_conHeight-g_barHeight)),$("channel_in").setStyle("marginTop",-(c*(g_conHeight-g_barHeight)/(g_barHeight-g_blkHeight)+50*b))):b>0?($("block5").setStyle("top",g_barHeight-g_blkHeight),$("channel_in").setStyle("marginTop",-(g_conHeight-g_barHeight))):0>b&&($("block5").setStyle("top",0),$("channel_in").setStyle("marginTop",0)),a.preventDefault?a.preventDefault():a.returnValue=!1,a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}function openRemote(a,b){$(a).hasClass("cl1")?connectRemote(b,-1):ocx.DisConnectRemoteVideo(b)}function connectRemote(a,b){var c=jsonDecodeSrc[0][a];if(c.Enable){var d=c.Device;if($chk(d)){var e=c.VideoChannel,f=["Main","Extra1","Extra2","Extra3"].indexOf(c.VideoStream),g=jsonRemoteDev[d].Address,h=(jsonRemoteDev[d].Port,jsonRemoteDev[d].UserName),i=jsonRemoteDev[d].Password,j="rtsp://"+g+"/cam/realmonitor?channel="+(e+1)+"&subtype="+f;getVideoWidgetConfig(a),ocx.ConnectRemoteVideo(a,j,h,i,b)}else alert("The channel is not  set.")}else alert("Disabled!")}function getdjl(){var a=talkTypes;a=a.substr(0,a.length-1);var b="";if("0&"!==a&&""!==a){var c=a.split("&"),d=0;g_audiotype=$unlink(c),g_audiotype.include(0);for(var e=0;e<c.length;e++)""!=c[e]&&(c.contains("0")||0!=d||(d=1,settings.talktype=c[e],b+="<li><a id='audiotype_0' href='javascript:;'  onclick='onmnudj(this, "+c[e]+")'>"+TALK_CODING_TYPE[0]+"</a></li>"),b+="<li><a id='audiotype_"+c[e]+"' href='javascript:;'  onclick='onmnudj(this, "+c[e]+")'>"+TALK_CODING_TYPE[c[e]-0]+"</a></li>");$("mnudjl").innerHTML=b}}function OntalkType(){var a=settings.talktype;g_audiotype.each(function(b){1==gdj&&a==b?$("audiotype_"+b).addClass("audiotype_sel"):$("audiotype_"+b).removeClass("audiotype_sel")})}function rfc(){try{var a=ConfigManager.instance(),b=function(a){var b=JSON.decode(a).params.table;$$("#channel_in span.chl_name").each(function(a,c){$("chl"+c).setProperty("title",reps(b[c].Name)),a.setProperty("text",reps(b[c].Name))})};a.getConfig("ChannelTitle",b,!0)}catch(c){var d,e=new Array,f=new Array,g=String.fromCharCode(9),h=String.fromCharCode(16);if(d=ocx.GetChannelName(),""!=d){d=d.substr(0,d.length-1),e=d.split(g);for(var i=0;i<e.length;i++){f=e[i].split(h);var j="chl"+f[0];$(j).set("innerHTML",f[1]),e[i]=f}}}}function reboot(){if(!parent.checkAuthority("ShutDown"))return void alert(tl("com_msg.No Right"));if(confirm(tl("com_msg.rebootconfirm"))){var a=new MagicBox,b=function(a){JSON.decode(a).result?lo():alert(tl("com_msg.rebootfail"))};a.reboot(b)}}function openall(){parent.hasPlugin&&(0==gopenall?g_is5xLFSL&&Sys.ie?(ocx.DisConnectAllChannel(),ocx.ConnectChannels(0,16,1)):ocx.ConnectAllChannelEx(settings.openall.toInt()):(ocx.DisConnectAllChannel(),settings.openall="2"))}function closebeep(){ocx.BeepAlarmControl(0)}function limitPs(){var a=$("ps").value;$("ps").value=a.replace(/[^\d]/g,""),"0"==a?$("ps").value=1:"9"==a&&($("ps").value=8)}function resumePlay(){if(g_closeAll=!1,1==g_netType)ocx.SetModuleMode(10),ocx.SetWinBindedChannel(wanVideoNum,0,wanStartChannel,wanStartChannel+wanVideoNum-1),ocx.ConnectWanMultiRealVideo(wanStartChannel,wanStartChannel+wanVideoNum-1);else for(var a=0;a<playInfoRecBak.length;a++)playInfoRecBak[a].state>0&&ocx.ConnectRealVideoEx(playInfoRecBak[a].chnlNo,playInfoRecBak[a].state,playInfoRecBak[a].windowID);1==multiPreview.multiPreviewStateBak.state&&ocx.ConnectRealVideoEx(multiPreview.multiPreviewStateBak.channel,multiPreview.multiPreviewStateBak.streamType,multiPreview.multiPreviewStateBak.windowID),-1!=gch_sel&&$chk(playInfoRecBak[gch_sel])&&playInfoRecBak[gch_sel].state>0&&!(multiPreview.multiPreviewStateBak.state>0&&multiPreview.multiPreviewStateBak.windowID==gwid)&&resumeEQbuttonStates(gch_sel)}function gotoPreview(){}function closeAllVideos(){parent.hasPlugin&&(g_closeAll||(playInfoRecBak=$unlink(playInfoRec),multiPreview.multiPreviewStateBak=$unlink(multiPreview.multiPreviewState),ocx.DisConnectAllChannel(),g_closeAll=!0))}function goLogout(){1==gdj&&ocx.ControlTalking(0),$("Vertical_Sync").hasClass("ui-video-icon-current")&&$("Vertical_Sync").removeClass("ui-video-icon-current"),Sys.ie&&(parent.hasPlugin&&(ocx.DisConnectAllChannel(),ocx.LogoutDevice()),g_closeAll=!1),closemnudj(),1==gdj&&(gdj=0,$("xdj_label").innerText=tl("com_str.start talk"),$("xdj").removeClass("ui-button-current")),1==gopenall&&(gopenall=0,$("xac_label").innerText=tl("com_str.openall"),$("xac").removeClass("ui-button-current"));var a=$("channel_in"),b=a.getElement("ul[id=prew_cmu]");b&&$("channel_mid").adopt(b),a.empty(),$("rc1all").hasClass("ui-button-current")&&$("rc1all").removeClass("ui-button-current"),multiPreview.closemnuyl(),cimaexpara=null,gch_sel=-1}function showabout(){ocx.AboutBox()}function adjustVideoSize(a,b){var c=a-$("pre_left").getStyle("width").replaceToNum()-$("pre_righter").getStyle("width").replaceToNum()-37,d=b-36;(d!=parseInt($("mbb").getStyle("height")-g_playCtrH)||c!=parseInt($("mbb").getStyle("width")))&&($("mbb").setStyle("height",d-g_playCtrH),$("mbb").setStyle("width",c),$("left_bot").setStyle("height",d-500),$("left_bot").setStyle("min-height",120),"none"==$("ayt22").getStyle("display")?($("yt3t1").setStyle("height",d-534),$("yt3t2").setStyle("height",d-534)):"none"==$("yt21").style.display||$("ayt22").hasClass("pre-right-bar-item-up")?($("yt3t1").setStyle("height",d-310),$("yt3t2").setStyle("height",d-310)):($("yt3t1").setStyle("height",d-500),$("yt3t2").setStyle("height",d-500)))}function resize(){return}function onPageDomReady(){if($("previewcon").translation(),1!=gdomready){g_channel_in=$("channel_in"),gsld=new Slider($("sa"),$("sk"),{steps:1e3,onChange:function(a){POS_FLAG&&ocx.SetLocalPlayTime(a,1e3),POS_FLAG=!0,POS_SET=a}}),gslda=new Slider($("saa"),$("ska"),{steps:128,onChange:function(a){setcolorsv(1,a),setcolors()}}),gsldb=new Slider($("sab"),$("skb"),{steps:128,onChange:function(a){setcolorsv(2,a),setcolors()}}),gsldc=new Slider($("sac"),$("skc"),{steps:128,onChange:function(a){setcolorsv(3,a),setcolors()}}),gsldd=new Slider($("sad"),$("skd"),{steps:128,onChange:function(a){setcolorsv(4,a),setcolors()}}),volumeSlider=new Slider("speedBg","SpeedControl",{steps:8,wheel:!0,range:[0,8],onChange:function(a){var b=$("speedBg").getSize().x/8*a;b>$("speedBg").getSize()&&(b=$("speedBg").getSize()),$("speed_changeBar").style.width=b+"px",$("ps").value=a},onComplete:function(a){$("ps").value=a}}).set(5),$("xac_show").addEvent("click",function(a){parent.hasPlugin&&(showmnuopen(),preventBubble(a))}),$("xdj_show").addEvent("click",function(a){parent.hasPlugin&&(OntalkType(),showmnudj(),preventBubble(a))}),$("screen_show").addEvent("click",function(a){parent.hasPlugin&&(multiPreview.showmnuyl(),preventBubble(a))}),$("openPreview").addEvent("click",function(a){ocx.ConnectRealVideo(0,7),a.stop()});var a=($("mb"),$("drb"),$("mba"),$("mbb"),$("mbc"),$("dra"),$("drc"),new Fx.Tween("yt21","height",{duration:500})),b=new Fx.Tween("yt3t1","height",{duration:500}),c=new Fx.Tween("yt3t2","height",{duration:500});"none"==$("ayt22").getStyle("display")&&($("yt21").style.display="block"),$("ayt22").addEvent("click",function(d){if(new Event(d).stop(),this.hasClass("pre-right-bar-item-up")){$("yt21").style.display="block",this.removeClass("pre-right-bar-item-up"),this.addClass("pre-right-bar-item-down"),a.start("height",0,190);var e=parseInt($("yt3t1").style.height);b.start("height",e,e-190),c.start("height",e,e-190)}else{this.removeClass("pre-right-bar-item-down"),this.addClass("pre-right-bar-item-up"),$("yt21").style.display="block",a.start("height",190,0);var e=parseInt($("yt3t1").style.height);b.start("height",e,e+190),c.start("height",e,e+190)}});var d=$("advptz"),e=$("otherptz");d.addEvent("click",function(a){new Event(a).stop(),this.addClass("pre-right-title-item-current"),e.removeClass("pre-right-title-item-current"),$("pztcon").style.display="",$("boatmenu").style.display="none"}),e.addEvent("click",function(a){new Event(a).stop(),this.addClass("pre-right-title-item-current"),d.removeClass("pre-right-title-item-current"),$("pztcon").style.display="none",$("boatmenu").style.display=""});var f=$("taba1"),g=$("taba2");f.addEvent("click",function(a){new Event(a).stop(),this.addClass("pre-right-title-item-current"),g.removeClass("pre-right-title-item-current"),$("yt3t1").style.display="",$("yt3t2").style.display="none"}),g.addEvent("click",function(a){new Event(a).stop(),this.addClass("pre-right-title-item-current"),f.removeClass("pre-right-title-item-current"),$("yt3t1").style.display="none",$("yt3t2").style.display=""}),$("b_xxsm1").addEvent("click",function(){cleanStatus(),controlPtz(!0,"AutoScanOn",0,0,0)&&($("b_xxsm1").style.display="none",$("b_xxsm2").style.display="",g_currentPtzStatus=1)}),$("b_xxsm2").addEvent("click",function(){controlPtz(!0,"AutoScanOff",0,0,0)&&($("b_xxsm1").style.display="",$("b_xxsm2").style.display="none",g_currentPtzStatus=0)}),$("b_setleft").addEvent("click",function(){controlPtz(!0,"SetLeftLimit",0,0,0)}),$("b_setright").addEvent("click",function(){controlPtz(!0,"SetRightLimit",0,0,0)}),$("b_yzd1").addEvent("click",function(){cleanStatus(),controlPtz(!0,"GotoPreset",$("i_yzd").value-0,0,0)}),$("b_addyzd").addEvent("click",function(){cleanStatus(),controlPtz(!0,"SetPreset",$("i_yzd").value-0,0,0)}),$("b_delyzd").addEvent("click",function(){cleanStatus(),controlPtz(!0,"ClearPreset",$("i_yzd").value-0,0,0)}),$("b_xhz1").addEvent("click",function(){cleanStatus(),controlPtz(!0,"StartTour",$("i_xhz").value-0+1,0,0)&&($("b_xhz1").style.display="none",$("b_xhz2").style.display="",$("d_ptzset2").style.display="none",g_currentPtzStatus=3)}),$("b_xhz2").addEvent("click",function(){controlPtz(!0,"StopTour",$("i_xhz").value-0+1,0,0)&&($("b_xhz1").style.display="",$("b_xhz2").style.display="none",g_currentPtzStatus=0)
}),$("b_addxhz").addEvent("click",function(){$("zjxhz").style.display=""}),$("b_delxhz").addEvent("click",function(){controlPtz(!0,"ClearTour",$("i_xhz").value-0+1,0,0)}),$("b_addpnt").addEvent("click",function(){controlPtz(!0,"AddTour",$("i_xhz").value-0+1,$("i_pnt").value-0,0)}),$("b_delpnt").addEvent("click",function(){controlPtz(!0,"DelTour",$("i_xhz").value-0+1,$("i_pnt").value-0,0)}),$("b_xj1").addEvent("click",function(){cleanStatus(),controlPtz(!0,"StartPattern",$("i_xj").value-0,0,0)&&($("b_xj1").style.display="none",$("b_xj2").style.display="",g_currentPtzStatus=4)}),$("b_xj2").addEvent("click",function(){controlPtz(!0,"StopPattern",$("i_xj").value-0,0,0)&&($("b_xj1").style.display="",$("b_xj2").style.display="none",g_currentPtzStatus=0)}),$("b_startjl").addEvent("click",function(){controlPtz(!0,"SetPatternBegin",$("i_xj").value-0,0,0)}),$("b_stopjl").addEvent("click",function(){controlPtz(!0,"SetPatternEnd",$("i_xj").value-0,0,0)}),$("b_delxj").addEvent("click",function(){controlPtz(!0,"ClearPattern",$("i_xj").value-0,0,0)}),$("b_AutoPanOn").addEvent("click",function(){cleanStatus(),controlPtz(!0,"AutoPanOn",0,0,0)&&($("b_AutoPanOn").style.display="none",$("b_AutoPanOff").style.display="",g_currentPtzStatus=5)}),$("b_AutoPanOff").addEvent("click",function(){cleanStatus(),controlPtz(!0,"AutoPanOff",0,0,0)&&($("b_AutoPanOn").style.display="",$("b_AutoPanOff").style.display="none",g_currentPtzStatus=0)}),$("b_fzk1").addEvent("click",function(){controlPtz(!0,"AuxOn",$("i_fzz").value-0,0,0)}),$("b_fzk2").addEvent("click",function(){controlPtz(!0,"AuxOff",$("i_fzz").value-0,0,0)}),$("b_lighton").addEvent("click",function(){parent.jsonWebCaps.b_supportWiper?(controlPtz(!0,"SetPreset",100,0,0),controlPtz(!0,"GotoPreset",77,0,0),controlPtz(!0,"GotoPreset",51,0,0)):controlPtz(!0,"LampWaterClear",1,0,0)}),$("b_lightoff").addEvent("click",function(){parent.jsonWebCaps.b_supportWiper?(controlPtz(!0,"GotoPreset",100,0,0),controlPtz(!0,"GotoPreset",78,0,0)):controlPtz(!0,"LampWaterClear",0,0,0)}),$("b_turnOver").addEvent("click",function(){controlPtz(!0,"Flip",0,0,0)}),$("b_ptzReset").addEvent("click",function(){controlPtz(!0,"Reset",0,0,0)}),$("b_xsset").addEvent("click",function(){showPtzset(0)}),$("b_xhset").addEvent("click",function(){"none"!=$("b_xhz1").style.display&&showPtzset(2)}),$("b_xjset").addEvent("click",function(){showPtzset(3)}),$("b_fzset").addEvent("click",function(){showPtzset(4)}),$("b_ctrlmenu").addEvent("click",function(){controlPtz(!0,"Menu",0,0,0)}),$("b_ctrlmenu1").addEvent("click",function(){controlPtz(!0,"Exit",0,0,0)}),$("boat1").addEvent("click",function(){controlPtz(!0,"MenuUp",0,0,0)}),$("boat2").addEvent("click",function(){controlPtz(!0,"MenuLeft",0,0,0)}),$("boat3").addEvent("click",function(){controlPtz(!0,"Enter",0,0,0)}),$("b_enter").addEvent("click",function(){controlPtz(!0,"Enter",0,0,0)}),$("boat4").addEvent("click",function(){controlPtz(!0,"MenuRight",0,0,0)}),$("boat5").addEvent("click",function(){controlPtz(!0,"MenuDown",0,0,0)}),$("prew_video_fullScreen").addEvent("click",function(){ocx.OnFullScreenClk()}),$("prew_video_quality").addEvent("click",function(a){"none"==$("prew_olay1").getStyle("display")?(closeIconMenus(),$("prew_olay1").setStyle("display","")):closeIconMenus(),a.stop()}),$("Vertical_Sync").addEvent("click",function(){0!=g_isCanClickVerticalSync&&(g_isCanClickVerticalSync=!1,$("Vertical_Sync").hasClass("ui-video-icon-current")?ocx.VerticalSyncEnable(0)&&($("Vertical_Sync").removeClass("ui-video-icon-current"),setTimeout(function(){g_isCanClickVerticalSync=!0},200)):ocx.VerticalSyncEnable(1)&&($("Vertical_Sync").addClass("ui-video-icon-current"),setTimeout(function(){g_isCanClickVerticalSync=!0},200)))}),$("prew_video_fluency").addEvent("click",function(a){"none"==$("prew_olay2").getStyle("display")?(closeIconMenus(),$("prew_olay2").setStyle("display","")):closeIconMenus(),a.stop()}),$$("#prew_olay1 a").each(function(a,b){a.addEvent("click",function(a){ocx.SetPicQuality(1-b),$$("#prew_olay1 a").removeClass("ui-videoicon-list-current"),this.addClass("ui-videoicon-list-current"),$("prew_olay1").setStyle("display","none"),a.stop()})}),$$("#prew_olay2 a").each(function(a,b){a.addEvent("click",function(a){ocx.SetAdjustFluency(b),$$("#prew_olay2 a").removeClass("ui-videoicon-list-current"),this.addClass("ui-videoicon-list-current"),$("prew_olay2").setStyle("display","none"),a.stop()})}),getJsonlang(),hideFunctions(),gdomready=1}}function initAndBindVideoScreen(){initSplitIcons("prew_scrn","prew_video_screen"),[1,4,6,8,9,13,16,20,25,36].each(function(a){$$("#prew_scrn"+a+" a").addEvent("click",function(b){var c=this.get("text").split("-");null==c[1]&&(c[1]=c[0]),1==g_netType&&(ocx.SetWinBindedChannel(a,0,parseInt(c[0])-1,parseInt(c[1])-1),ocx.ConnectWanMultiRealVideo(parseInt(c[0])-1,parseInt(c[1])-1),cimaexpara&&cimaexpara.channelChange(parseInt(c[0])-1),wanVideoNum=a,wanStartChannel=parseInt(c[0])-1),$$("#prew_scrn"+a+" a").removeClass("ui-videoicon-list-current"),this.addClass("ui-videoicon-list-current"),$("prew_scrn"+a).setStyle("display","none"),b.stop()}),$("prew_video_screen"+a).removeEvents().addEvent("click",function(b){1==g_netType?("none"==$("prew_scrn"+a).getStyle("display")?(closeIconMenus(),$("prew_scrn"+a).setStyle("display","")):closeIconMenus(),b.stop()):ocx.SetWinBindedChannel(a,gwid,0,a-1)})})}function initSplitIcons(a,b){for(var c=CHANNEL_NUMBER,d=[1,4,6,8,9,13,16,20,25,36],e=0;e<d.length;e++)if(!(e>0&&c<=d[e-1])||8==c&&9==d[e]||c>9&&16==d[e]){$(b+d[e]).style.display="";for(var f="",g=Math.ceil(c/d[e]),h=0;g>h;h++)if(1==d[e])f+='<a href="javascript:;"'+(0==h?'class="ui-videoicon-list-current"':"")+">"+(h+1)+"</a>";else if(32>=c&&9==d[e]&&c%8==0){var i=[];i=8==c?["1-8"]:16==c?["1-9","8-16"]:24==c?["1-9","8-16","16-24"]:["1-9","8-16","17-25","24-32"],f+='<a href="javascript:;"'+(0==h?'class="ui-videoicon-list-current"':"")+">"+i[h]+"</a>"}else{var j=h*d[e]+1,k=(h+1)*d[e];h+1>=g&&(k=c,j=Math.max(c-d[e]+1,1)),f+='<a href="javascript:;"'+(0==h?'class="ui-videoicon-list-current"':"")+">"+j+"-"+k+"</a>"}0!=parent.Ability.previewSplitNumList.length&&"prew_winScrn"==a&&-1==parent.Ability.previewSplitNumList.indexOf(d[e])&&($(b+d[e]).style.display="none"),$(a+d[e]).innerHTML=f}else $(b+d[e]).style.display="none";isMac&&"prew_window_apart"==b&&($(b+"25").style.display="none",$(b+"36").style.display="none")}function closeIconMenus(){$$("#prew_video_control div.ui-videoicon-list").setStyle("display","none"),$$("#prew_video_control div.ui-videoicon-listEx").setStyle("display","none")}function closePreScrn(){[1,4,6,8,9,13,16,20,25,36].each(function(a){$("prew_scrn"+a).setStyle("display","none")}),$("prew_olay1").setStyle("display","none"),$("prew_olay2").setStyle("display","none")}function getPtzIndex(a){for(var b=$("ytszSelect").getElements("option"),c=0;c<b.length;c++)if(b[c].value==a)return c}function attachInputLimit(){var a=new PtzCtrl,b=function(a,b){var c=$("ytszSelect").value;if($("ytszSelect").innerHTML="",$("ytszSelect").options.add(new Option(tl("opr_ptz.Auto-Scan"),"xxsmCon")),$("ytszSelect").options.add(new Option(tl("opr_ptz.Preset"),"yzdCon")),$("ytszSelect").options.add(new Option(tl("ctrl_ptz.cruise"),"xhzCon")),$("ytszSelect").options.add(new Option(tl("opr_ptz.Pattern"),"xjCon")),$("ytszSelect").options.add(new Option(tl("opr_ptz.Auto-Pan"),"xzCon")),$("ytszSelect").options.add(new Option(tl("opr_ptz.AUX"),"fzCon")),$("ytszSelect").options.add(new Option(tl("opr_ptz.LampWaterClear"),"dgCon")),$("ytszSelect").options.add(new Option(tl("opr_ptz.Flip"),"turnCon")),$("ytszSelect").options.add(new Option(tl("opr_ptz.Reset"),"fwCon")),b.result&&b.params&&b.params.caps){var d=b.params.caps;d.Preset&&(attachLimitEx("i_yzd",d.PresetMin,d.PresetMax,d.PresetMax.toString().length),$("title_minPreset").set("text",d.PresetMin),$("title_maxPreset").set("text",d.PresetMax),attachLimitEx("i_pnt",d.PresetMin,d.PresetMax,d.PresetMax.toString().length),$("title_minPnt").set("text",d.PresetMin),$("title_maxPnt").set("text",d.PresetMax)),d.Pattern&&(attachLimitEx("i_xj",d.PatternMin,d.PatternMax,d.PatternMax.toString().length),$("title_PatternMin").set("text",d.PatternMin),$("title_PatternMax").set("text",d.PatternMax)),d.Auxs&&(attachLimitEx("i_fzz",d.AuxMin,d.AuxMax,d.AuxMax.toString().length),$("title_AuxMin").set("text",d.AuxMin),$("title_AuxMax").set("text",d.AuxMax)),d.Tour&&(attachLimitEx("i_xhz",d.TourMin,d.TourMax,d.TourMax.toString().length),$("title_TourMin").set("text",d.TourMin),$("title_TourMax").set("text",d.TourMax)),d.Pan||$("ytszSelect").options.remove(getPtzIndex("xzCon")),d.SetLimit||$("ytszSelect").options.remove(getPtzIndex("xxsmCon")),d.Preset||$("ytszSelect").options.remove(getPtzIndex("yzdCon")),d.Tour||$("ytszSelect").options.remove(getPtzIndex("xhzCon")),d.Pattern||$("ytszSelect").options.remove(getPtzIndex("xjCon")),d.Auxs||($("ytszSelect").options.remove(getPtzIndex("fzCon")),$("ytszSelect").options.remove(getPtzIndex("dgCon"))),d.Flip||$("ytszSelect").options.remove(getPtzIndex("turnCon")),d.Reset||$("ytszSelect").options.remove(getPtzIndex("fwCon")),$chk(c)?$("ytszSelect").value=c:$("ytszSelect").selectedIndex=-1,$("ytszSelect").selectedIndex<0&&($("ytszSelect").selectedIndex=0,c=$("ytszSelect").value),changePtzSetup(c),$("b_delyzd").style.display=getDisplay(d.RemovePreset),$chk(d.MoveRelatively)?($("cptz").hasClass("ui-ptz-specail-icon-disabled")&&($("cptz").removeClass("ui-ptz-specail-icon-disabled"),$("cptz").removeClass("ui-ptz-specail-icon-current")),g_moveRelatively=!0):($("cptz").removeClass("ui-ptz-specail-icon-current"),$("cptz").addClass("ui-ptz-specail-icon-disabled"),g_moveRelatively=!1),""==$("ytszSelect").innerHTML?($("advptz").style.display="none",$("pztcon").style.display="none",$("boatmenu").style.display="",$("advptz").removeClass("pre-right-title-item-current"),$("otherptz").addClass("pre-right-title-item-current")):($("advptz").style.display="",$("advptz").hasClass("pre-right-title-item-current")?($("pztcon").style.display="",$("boatmenu").style.display="none"):($("pztcon").style.display="none",$("boatmenu").style.display=""))}else attachLimitEx("i_yzd",1,80,2),attachLimitEx("i_xhz",0,7,1),attachLimitEx("i_pnt",1,80,2),attachLimitEx("i_xj",1,5,1),attachLimitEx("i_fzz",1,8,1),$("title_minPreset").set("text",1),$("title_maxPreset").set("text",80),$("title_TourMin").set("text",0),$("title_TourMax").set("text",7),$("title_minPnt").set("text",1),$("title_maxPnt").set("text",80),$("title_PatternMin").set("text",1),$("title_PatternMax").set("text",5),$("title_AuxMin").set("text",1),$("title_AuxMax").set("text",8),$("cptz").className="ui-ptz-specail-icon",$("b_delyzd").style.display="block",changePtzSetup($("ytszSelect").value),g_moveRelatively=!0};a.getProtocolCaps(b,gch_sel>0?gch_sel:0)}function getDisplay(a){return a?"block":"none"}function limit(a,b){var c=$(a).value;$(a).value=c.replace(/[^\d]/g,"");var d=$(a).value-0;return d>b?($(a).value=b,b):d}function limitMin(a,b){var c=a.value;b>=c-0&&(a.value=b)}function attachLimit(a,b,c,d){var e=$(a);void 0!=d&&e.setProperty("maxlength",d),e.removeEvents("keyup"),e.removeEvents("blur"),e.addEvents({keyup:function(a){"backspace"!=a.key&&"left"!=a.key&&"right"!=a.key&&(e.value=e.value-0,limit(this,c))},blur:function(){e.value=e.value-0,limit(this,c),limitMin(this,b)}})}function closeMenus(){1==gfmnuopen&&closemnuopen(),1==gfmnudj&&closemnudj(),multiPreview.closemnuyl(),closeIconMenus()}function preventBubble(a){Sys.ie?event.cancelBubble=!0:a.stopPropagation()}function cptzEx(){if(1==multiPreview.multiPreviewState.state&&multiPreview.multiPreviewState.windowID==gwid)return void alert(tl("opr_ocx.Can't control PTZ of which channel is in the state of realplay!"));if(g_moveRelatively){if(!parent.checkAuthority("MPTZ"))return void alert(tl("com_msg.Please set the Authority of this IP!"));if(1!=gst_sel&&10!=gst_sel)return void alert(tl("opr_ocx.Can't control PTZ of which channel is in the state of realplay!"));if(getPtzCfg(),"NONE"==jsonPTZ[gch_sel-0].ProtocolName&&0==jsonPTZ[gch_sel-0].PTZType)return void alert(tl("com_msg.Please set PTZ protocol of this channel first!"));0==gptz?(gptz=1,ocx.ControlPtz(51,0,0,0,gwid)):2==gptz?(gptz=1,ocx.ControlPtz(51,0,0,0,gwid)):(gptz=0,ocx.ControlPtz(51,0,0,0,gwid)),setptzs()}}function getPtzCfg(){var a=ConfigManager.instance(),b=function(a){jsonPTZ=JSON.decode(a).result?JSON.decode(a).params.table:""};a.getConfig("Ptz",b,!1)}function setptzs(){1==gdomready&&(0==gptz?$("cptz").hasClass("ui-ptz-specail-icon-current")&&$("cptz").removeClass("ui-ptz-specail-icon-current"):$("cptz").addClass("ui-ptz-specail-icon-current"))}function cdg(a,b,c){0==gdg?ocx.ControlPtz(14,1,0,0,gwid)&&(gdg=1,a.innerText=b):ocx.ControlPtz(14,0,0,0,gwid)&&(gdg=0,a.innerText=c)}function getProductDefinition(){var a=function(a,b){var c=!0;if(b.result&&"array"===$type(b.params)){var d=b.params;d[0].result&&d[0].params&&(g_ptzEnable=d[0].params.definition),d[1].result&&d[1].params&&(c=d[1].params.definition)}c||($("p_talk").style.display="none")},b=new MagicBox;b.getProductDef(["HasPtz","HasTalk"],a,!1)}function FireStateChangedEx(a,b,c,d){if(1==gdomready&&(64!=a||64==CHANNEL_NUMBER)){var e=-1;if("NVR"===parent.g_deviceType){for(var f=0;f<playInfoRec.length;f++)if(playInfoRec[f].chnlNo===a){e=f;break}if(-1===e)return}else e=a;0==b&&(ocx.ControlPtz(51,0,0,0,c),null==cimaexpara&&(cimaexpara=new ImageExPara),gch_sel==a&&(cimaexpara.disableshow(),fisheyeDisplay(!1)));var g;POS_SET=-1,c==gwid&&(gch_sel=a,gst_sel=b),-1!=a&&(g=$("chl"+a),0==b&&6>d&&closeStreamVideo(a),6>d&&(1==b?(playInfoRec[e].state||g_openNum++,d>=0&&2>=d&&(playInfoRec[e].state=d,playInfoRec[e].windowID=c,openStreamVideo(a,d)),gch_sel==a&&attachInputLimit()):(playInfoRec[e].state&&g_openNum--,playInfoRec[e].state=0,playInfoRec[e].windowID=-1)),d>=6&&14>=d&&(multiPreview.multiPreviewState.state=b,multiPreview.multiPreviewState.channel=a,multiPreview.multiPreviewState.windowID=c,multiPreview.multiPreviewState.streamType=d),g_openNum==playInfoRec.length?(gopenall=1,$("xac_label").setProperty("text",tl("com_str.closeall")),$("xac").addClass("ui-button-current")):(gopenall=0,$("xac_label").setProperty("text",tl("com_str.openall")),$("xac").removeClass("ui-button-current")),3==b&&g.addClass("pre-channel-green"),6==b&&g.addClass("pre-channel-yellow")),c==gwid&&(3==b||5==b||6==b?($("pbh").setStyle("display","none"),setprewolayPosition("show")):($("pbh").setStyle("display",""),setprewolayPosition("hide")),1==b&&getcolors())}}function FireReturnWindInfo(a,b,c,d,e,f,g){1==gdomready&&(c>0&&!(multiPreview.multiPreviewState.state>0&&multiPreview.multiPreviewState.windowID==a)?(cimaexpara||(cimaexpara=new ImageExPara),cimaexpara.channelChange(b)):(cimaexpara||(cimaexpara=new ImageExPara),cimaexpara.disableshow()),void 0==e&&(e=3),void 0==f&&(f=!1),void 0==g&&(g=!1),gptz=d,gwid=a,gch_sel=b,gst_sel=c,1==c&&attachInputLimit(),1==gdomready&&(0!=c?(5==c||4==c?($("pbh").setStyle("display","none"),setprewolayPosition("show")):($("pbh").setStyle("display",""),setprewolayPosition("hide")),getcolors()):($("pbh").setStyle("display",""),setprewolayPosition("hide")),setptzs(),2==gptz&&$("cptz").hasClass("ui-ptz-specail-icon-current")&&$("cptz").removeClass("ui-ptz-specail-icon-current"),$$("#prew_olay1 a").removeClass("ui-videoicon-list-current"),1==f?$("highQlt").addClass("ui-videoicon-list-current"):$("lowQlt").addClass("ui-videoicon-list-current"),$$("#prew_olay2 a").removeClass("ui-videoicon-list-current"),$$("#prew_olay2 a")[e].addClass("ui-videoicon-list-current"),1==g?$("Vertical_Sync").hasClass("ui-video-icon-current")||$("Vertical_Sync").addClass("ui-video-icon-current"):$("Vertical_Sync").hasClass("ui-video-icon-current")&&$("Vertical_Sync").removeClass("ui-video-icon-current")))}function FireReturnPlayState(a){if(1==gdomready){if(1!=a.open)return $("pbh").setStyle("display",""),void setprewolayPosition("hide");$("pbh").setStyle("display","none"),setprewolayPosition("show");var b=1e3*a.playTime/a.totalTime;POS_FLAG?POS_FLAG=!1:b>POS_SET&&(POS_SET=-1),sldtoposEx(b)}}function checkLimit(a,b,c){var d=$(b).get("text"),e=$(c).get("text");($(a).value-0<d-0||$(a).value-0>e-0)&&($(a).value=d+"")}function changePtzSetup(a){checkLimit("i_yzd","title_minPreset","title_maxPreset"),checkLimit("i_xhz","title_TourMin","title_TourMax"),checkLimit("i_xj","title_PatternMin","title_PatternMax"),checkLimit("i_fzz","title_AuxMin","title_AuxMax"),$("xxsmCon").style.display="none",$("yzdCon").style.display="none",$("xhzCon").style.display="none",$("xjCon").style.display="none",$("xzCon").style.display="none",$("fzCon").style.display="none",$("dgCon").style.display="none",$("turnCon").style.display="none",$("fwCon").style.display="none",a&&$(a)&&($(a).style.display="")}function showPtzset(a){$("d_ptzset"+a).style.display="none"==$("d_ptzset"+a).style.display?"":"none"}function cleanStatus(){switch(g_currentPtzStatus){case 1:$("b_xxsm2").fireEvent("click"),g_currentPtzStatus=0;break;case 2:break;case 3:$("b_xhz2").fireEvent("click"),g_currentPtzStatus=0;break;case 4:$("b_xj2").fireEvent("click"),g_currentPtzStatus=0}}function setprewolayPosition(a){if("show"==a)$("prew_olay1").style.top="50px",$("prew_olay2").style.top="50px";else{var b=$("prew_video_control").getStyle("height").replaceToNum();$("prew_olay1").style.top=b+"px",$("prew_olay2").style.top=b+"px"}}function chkPlayInfo(a){for(ch=0;ch<CHANNEL_NUMBER-1;ch++)if(a[ch].state!=a[ch+1].state)return!1;return!0}function addBg(a){$("boat_current").addClass("ui-boat-current-"+a)}function removeBg(a){$("boat_current").removeClass("ui-boat-current-"+a)}function addPtzBg(a){$("yt").addClass("ui-ptz-boat-"+a)}function removePtzBg(a){$("yt").removeClass("ui-ptz-boat-"+a)}function hideFunctions(){}function setSoundClass(a,b){$("sound"+a).className=b}function autoReConnect(){setTimeout(function(){if($("xdj").hasClass("ui-button-current")){ocx.SetDeviceMode(0,settings.talktype-0);var a=ocx.ControlTalking(1);if(1==a)gdj=1;else{var b=$("xdj"),c=$("xdj_label"),d=tl("com_str.start talk");c.innerText=d,c.setProperty("text",d),b.removeClass("ui-button-current")}}},5e3)}function getRecordCap(){var a=RecordMan.instance();a.getCaps(function(a,b){b.result&&(maxStreams=b.params.caps.MaxStreams,parent.Ability.packetLengthRange=b.params.caps.PacketLengthRange||null,parent.Ability.packetSizeRange=b.params.caps.PacketSizeRange||null,parent.Ability.isResumeTransmit=b.params.caps.SupportResumeTransmit||null,b.params.caps.TimeSection&&b.params.caps.TimeSection.contains("Extra1")&&(parent.Ability.b_supportExtra1=!0))})}function fisheyeDisplay(a){a?($("pre_fisheye").style.display="",$("ptzAll").style.display="none",$("ayt22").style.display="none"):($("pre_fisheye").style.display="none",$("ptzAll").style.display="",$("ayt22").style.display="")}function showFishEye(a){jQuery("#pre_fisheye").fisheye({iid:"preview",ocxObject:parent.g_ocx,chArry:g_addDevCh,datafor:["0","1","2","3","5","6","8","10","11","12","16"],oStrTmpl:{tlFishFit:tl("fisheye.fitmode"),tlFishShow:tl("fisheye.showmode")}}),a.fisheyeinfo&&a.fisheyeinfo.Enable?(jQuery("#pre_fisheye").fisheye("onVideoFishEyeClick",a),fisheyeDisplay(!0)):fisheyeDisplay(!1)}var CHANNEL_NUMBER=0,REMOTE_CHANNELS=0,jsonDecodeSrc,jsonRemoteDev,jsonChannels=[],jsonRemoteDevice=[],jsonPTZ="",POS_SET=-1,POS_FLAG=!1,ID_REQUEST_EX=1e4,gdomready=0,gopenall=0,gsld,gslda,gsldb,gsldc,gsldd,volumeSlider,cimaexpara=null,gsldchl,gca=0,gcb=0,gcc=0,gcd=0,gwid=0,gptz=0,gxh=0,gxz=0,gxs=0,gxj=0,gdj=0,gdg=0,gfmnudj=0,gomnudj=null,gfmnuopen=0,gomnuopen=null,i=0,j=0,glhight=0,grhight=287,gch_sel=-1,gst_sel=-1,playInfoRec=[],playInfoRecBak=[],g_strmTips=["","P","E","E"],g_maxExtra=parent.Ability.capAbility(),g_netType=0,isMac=-1!=navigator.userAgent.toLowerCase().indexOf("mac");window.Base64=parent.Base64,window.hex_md5=parent.hex_md5,window.RPC=parent.RPC;var g_conHeight=0,g_barHeight=0,g_blkHeight=0,g_playCtrH=25,g_ptzEnable=!0,g_currentPtzStatus=0,g_openNum=0,g_channel_in="",g_moveRelatively=!0,g_audiotype=new Array,g_is5xLFSL=!1,g_isCanClickVerticalSync=!0,Sys={},ua=navigator.userAgent.toLowerCase(),s;(s=ua.match(/(msie\s|trident.*rv:)([\d.]+)/))?Sys.ie=s[2]:(s=ua.match(/firefox\/([\d.]+)/))?Sys.firefox=s[1]:(s=ua.match(/chrome\/([\d.]+)/))?Sys.chrome=s[1]:(s=ua.match(/opera.([\d.]+)/))?Sys.opera=s[1]:(s=ua.match(/version\/([\d.]+).*safari/))?Sys.safari=s[1]:0;var curLang="SimpChinese",jsonLang,ocx,wanVideoNum=0,wanStartChannel=-1;getJsonlang();var settings={username:"",pswd:"",talktype:"1",logintype:"0",openall:"2"},TALK_CODING_TYPE=["DEFAULT","PCM","G711a","AMR","G711u","G726","G723_53","G723_63","AAC","OGG"],jsonAlarmout="",jsonRecMode="",g_almChNO=0,g_LoginId=0,g_closeAll=!1,maxStreams=1,multiPreview=null;loadAllCssFile();var g_flag_over=!1;MagicBox.implement({getProcessInfoEx:function(a,b){void 0==b&&(b=!0);var c;c=this.getRequest("magicBox.getProcessInfoEx",'""'),sendRequest(c,a,b)}});var ImageExPara=new Class({Implements:Events,initialize:function(){this.isSupportEQ=parent.Ability.EQParam.isSupportEQ,this.isSupportMargin=parent.Ability.PositionParam.isSupportVideoPosition,this.isSupportPositionChannel=parent.Ability.PositionParam.videoSetsupportchannel,this.VideoPositionjson="",this.setInchan=-1,this.videoInputCh=0,this.gsldposition=null,this.bindEvent(),this.isSupportMargin&&($("divposition").style.display="block",this.gsldposition=new SliderEx($("eqp"),$("eqm"),{range:parent.Ability.PositionParam.positionRange,onComplete:function(a){return parent.checkAuthority("ColorSet")?(setcolorsv(5,a-0),void(1==gdomready&&cimaexpara.setVideoMargin())):(alert(tl("com_msg.No Right")),void cimaexpara.gsldposition.setValue($("eqm").title-0))}}),$("divposition").style.display="none")},bindEvent:function(){$("ars").addEvent("click",function(){return parent.checkAuthority("ColorSet")?void this.reSetEQ.call(this):void alert(tl("com_msg.No Right"))}.bind(this)),$("eqless").addEvent("click",function(){return parent.checkAuthority("ColorSet")?void this.gsldposition.set(this.gsldposition.step-1):void alert(tl("com_msg.No Right"))}.bind(this)),$("eqmore").addEvent("click",function(){return parent.checkAuthority("ColorSet")?void this.gsldposition.set(this.gsldposition.step+1):void alert(tl("com_msg.No Right"))}.bind(this))},reSetEQ:function(){this.isSupportEQ&&this.videoInputCh.resetEQ()},isCanSetEQ:function(){var a=function(a,b){return $("ars").setStyle("display","none"),b.result&&b.params.caps.EQ.SupportReset?($("ars").setStyle("display",""),!0):void 0};this.videoInputCh.getCapsEx("EQ",a)},setVideoMargin:function(){var a=ConfigManager.instance();this.VideoPositionjson.Input.Left=this.gsldposition.step-0;var b=this.VideoPositionjson;a.setConfigEx("VideoInMargin",this.setInchan,b)},getVideoMargin:function(a){var b=function(a,b){b.result&&(this.VideoPositionjson=b.params.table,null!=this.VideoPositionjson?(this.gsldposition.step=this.VideoPositionjson.Input.Left-0,this.gsldposition.knob.setStyle("left",this.gsldposition.toPosition(this.VideoPositionjson.Input.Left-0)),$("eqm").title=this.VideoPositionjson.Input.Left-0):$("divposition").setStyle("display","none"))},c=ConfigManager.instance();c.getConfigEx("VideoInMargin",a,b.bind(this))},isCanSetVideoPosition:function(a){return this.isSupportPositionChannel.contains(a)?($("divposition").setStyle("display","block"),!0):($("divposition").setStyle("display","none"),!1)},channelChange:function(a){if(this.setInchan=a,cimaexpara.isSupportMargin){var b=this.isCanSetVideoPosition(a);b&&this.getVideoMargin(a)}cimaexpara.isSupportEQ&&(this.videoInputCh=new VideoInput,this.videoInputCh.instance(a),this.videoInputCh.addEvent("endInstance",this.isCanSetEQ.bind(this,a)))},disableshow:function(){$("divposition").setStyle("display","none"),$("ars").setStyle("display","none")},defaultSetPosition:function(){this.isSupportMargin&&this.gsldposition.set(parent.Ability.PositionParam.defaultPostion)}}),MultiPreview=new Class({initialize:function(a,b){this.gfmnuyl=0,this.gomnuyl=null,this.deviceType=a,this.previewMode=b,this.multiPreviewState={state:0,channel:0,windowID:0,streamType:6},this.multiPreviewStateBak={},this.bindPreview()},isMutiPreviewShow:function(){if(""==this.previewMode)return!1;if("NVR"==this.deviceType)return!0;var a=-1,b=!1,c=LogicDeviceManager.instance();if(c.getCameraAll(function(b){if(JSON.decode(b).result){var c=JSON.decode(b).params.camera;if("array"==$type(c))for(var d=0;d<c.length;d++)if("Compose"==c[d].Type){a=c[d].Channel;break}}},!1),-1==a)return!1;var d=ConfigManager.instance();return d.getConfigEx("Encode",a,function(a,c){c.result&&(b=c.params.table.MainFormat[0].VideoEnable)},!1),b&&"0"==parent.$("s_lgType").value},showAndGetMultiPreview:function(){var a=this.isMutiPreviewShow();return a?"SnapShot"==this.previewMode?($("multiPreview").style.display="",$("preScrnApart").style.display="none"):($("multiPreview").style.display="none",$("preScrnApart").style.display=""):($("multiPreview").style.display="none",$("preScrnApart").style.display="none"),a},initPreview:function(){return initSplitIcons("prew_winScrn","prew_window_apart"),this},bindPreview:function(){var a=this;return $$("div[id^=prew_winScrn]").addEvent("click",function(b){"A"==b.target.tagName&&(a.bindPrew_winScrn.apply(a,[b.target.innerHTML.split("-"),this.id.replaceToNum()]),this.getChildren("a").removeClass("ui-videoicon-list-current"),b.target.addClass("ui-videoicon-list-current").getParent().setStyle("display","none"),b.stop())}),$$("a[id^=prew_window_apart]").addEvent("click",function(a){var b=this.getNext();"none"==b.getStyle("display")?(closeIconMenus(),b.setStyle("display","")):closeIconMenus(),a.stop()}),this},bindPrew_winScrn:function(a,b){null==a[1]&&(a[1]=a[0]);var c;switch(b){case 1:c=6;break;case 4:c=7;break;case 6:c=11;break;case 8:c=8;break;case 9:c=9;break;case 13:c=12;break;case 16:c=10;break;case 25:c=13;break;case 36:c=14}"SplitEncode"==this.previewMode?ocx.ConnectRealVideo(parseInt(a[0])-1,c):"SplitSnap"==this.previewMode&&this.openSplitSnapMultiPreview(b,a,c)},openSplitSnapMultiPreview:function(a,b,c){var d=new Split,e="Split"+a,f=0;f=8==a?8*Math.ceil((b[0]-1)/8):Math.ceil(b[1]/a)-1;var g=function(a,d){d.result?ocx.ConnectRealVideo(parseInt(b[0])-1,c):alert(tl("conf_ipcUpgrade.fail"))},h=function(a,b){b.result&&d.setMode(b.result,"General",e,f,"Local",g,!1)};d.instance(0,h,!1)},setMultiPreviewVideoOut:function(){if("NVR"==this.deviceType&&""!=this.previewMode){var a="",b=LogicDeviceManager.instance();if(b.getVideoInputChannels(function(b,c){a=c.result?c.params.channelCountInfo:""},!1),$chk(a.MaxComposite)&&a.MaxComposite){$("multiPreview").style.display="";var c="",d=ConfigManager.instance(),e=function(a){JSON.decode(a).result?c=JSON.decode(a).params.table:jsonPTZ=""};d.getConfig("VideoOut",e,!1);var f="",g=this;if($chk(c)){for(var h=0;h<c.length;h++)f+="<li><a href='javascript:;'  class='cdj1' index='"+h+"'>"+tl("com_msg.screen")+(h+1)+"</a></li>";return $("mnumuti").innerHTML=f,void $("mnumuti").getElements("a").addEvent("click",function(){g.onmnuyl.apply(g,[this,this.getProperty("index")])})}}}},showmnuyl:function(){0==this.gfmnuyl?(this.gfmnuyl=1,closemnuopen(),closemnudj(),$("mnumutipreview").style.display=""):$("mnumutipreview").style.display="none"},closemnuyl:function(){1==this.gfmnuyl&&(this.gfmnuyl=0,$("mnumutipreview").style.display="none")},onmnuyl:function(a,b){this.gomnuyl&&this.gomnuyl.hasClass("audiotype_sel")&&this.gomnuyl.removeClass("audiotype_sel"),this.gomnuyl=$(a),null!=this.gomnuyl&&this.gomnuyl.addClass("audiotype_sel"),ocx.SetDeviceMode(3,parseInt(b)),this.closemnuyl()}});$.subscribe("disConnected",function(){ocx.ControlTalking(0),gdj=0,top.clearInterval(top.g_timerAlive)});