function checkPlugins(){var a,b=!1;if(Sys.ie){try{a=new ActiveXObject(PLUGINS_NAME),b=!!a.CheckVersion(PLUGINS_VERSION),delete a}catch(c){return!1}b||a.DestoryATLThread()}else{navigator.plugins.refresh(!1);var d;if(d=isMac?MAC_PLUGIN_MAINTYPE:PLUGINS_MAINTYPE,a=navigator.mimeTypes[d],a&&a.enabledPlugin){if(isMac)return!0;b=checkInstallVersion(PLUGINS_VERSION,a.enabledPlugin.description.split("-")[2])}}return b}function checkInstallVersion(a,b){var c=a.split(".");if(b&&""!=b){var d=!0;return b.split(".").each(function(a,b){a.toInt()<c[b].toInt()&&(d=!1)}),d}return!1}function showPreviewOCX(a){function b(){checkPlugins()&&($("f_ocx").innerHTML=c,initPageOcx(),g_ocx.SetTranslateString(JSON.encode(jsonLang)),hasPlugin=!0,g_isRemoteLogin||loadOcxAxes())}$("f_ocx").innerHTML="";var c="";a?($("f_ocx").className="main-ocx",isWindows?c=Sys.ie?'<object id="ocx" width="100%" height="100%" classid="CLSID:{classid}"codebase="/webrec.cab"><param name="nActiveType" value=1></object>'.substitute({classid:PLUGINS_CLASSID}):'<object id="ocx" width="100%" height="100%" type="{mainType}" VideoWindTextColor="9c9c9c" VideoWindBarColor="414141" nActiveType="1"></object>'.substitute({mainType:PLUGINS_MAINTYPE}):isMac&&(c='<object id="ocx" width="100%" height="100%" type="application/media-plugin-version-1.0.0.1" VideoWindTextColor="9c9c9c" VideoWindBarColor="414141"></object>'),b()):isWindows?($("f_ocx").className="main-bg-noocx",c='<a id="pluginsetup" class="main-center-setup" href="/webplugin.exe" target="_download" onclick="reLoadPlugin()">'+tl("com_msg.needActivex")+"</a>"):isMac&&($("login_btn_install").setProperty("href","webplugin.pkg"),c='<object id="ocx" width="100%" height="100%" type="application/media-plugin-version-1.0.0.1" VideoWindTextColor="9c9c9c" VideoWindBarColor="414141"></object>')}function reLoadPlugin(){if(checkPlugins()){switch(showPreviewOCX(!0),g_ocx&&g_ocx.SetModuleMode(0==g_netType?1:10),g_pageID){case 0:changeOcxMode("Preview");break;case 1:changeOcxMode("Playback");break;case 2:var a=null!=g_frames.setup.document.getElementById("CAMERA");changeOcxMode(a?"Camera":"Hidden"),g_frames.setup.refreshPlugin();break;default:changeOcxMode("Hidden")}clearInterval(intervalID)}else intervalID||(intervalID=setInterval("reLoadPlugin()",2e3))}function showPluginSetup(){Sys.npapi||$("login_install_npapihint").setProperty("text",tl("comstring_npapitps")),$("login_install_dialog").style.display=""}function hideInstallDialog(){$("login_install_dialog").style.display="none",$("username")&&!g_isRemoteLogin&&(""!=$("username").value?$("password").focus():$("username").focus())}var agent=navigator.userAgent.toLowerCase(),isWindows=-1!=agent.indexOf("win"),isMac=-1!=agent.indexOf("mac");isMac&&(PLUGINS_VERSION=MAC_PLUGINS_VERSION);var hasPlugin=checkPlugins(),intervalID=null;