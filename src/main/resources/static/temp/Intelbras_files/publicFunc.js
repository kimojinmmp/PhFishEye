function getEachHtml(a,b,c){var d=b,e=$("cmaincont"),f=function(b){for(var d=!1,f=e.getElementsByTagName("*"),g=0,h=f.length;h>g;g++)Browser.freeMem(f[g]);if(e.innerHTML="",e.empty(),e.set("text",""),isIE&&CollectGarbage(),Cache[a])e.set("html",Cache[a]);else{var i=document.createElement("div");i.id="wrap_page_"+a,i.className="wrap_page_config",i.style.display="block",i.innerHTML=b,e.appendChild(i),initLang(),Cache[a]=i.outerHTML}e.translation();var j=document.createElement("script");j.setAttribute("type","text/javascript"),j.setAttribute("src",c),e.appendChild(j),j.onreadystatechange=function(){["loaded","complete"].contains(j.readyState)&&(d||(d=!0,onloadsuccess1()))},j.onload=function(){d||(d=!0,onloadsuccess1())}},g=function(){alert(tl("com_msg.getIPCcfgfailed"))};initLang=function(){},onloadsuccess1=$empty,Cache[a]?f():loadHtmlFile(d,f,g)}function gethtml(a){var b=$("set")||$("info");b&&b.fireEvent("pageunload"),parent.changeOcxMode("Hidden"),getEachHtml(a,"/html/"+a+".htm","/js/"+a+".js"),b&&b.removeEvents("pageunload")}function getPlatformHtml(a){parent.changeOcxMode("Hidden"),getEachHtml(a,"../platformHtm/"+a+".htm","../platformHtm/"+a+".js")}function preventBackButton(a){if(!isIE){var b=window.event||a;if(8==b.keyCode){var c=b.target.tagName.toLowerCase();"body"===c&&b.preventDefault()}}}function getlang(){if($chk(jsonLang))jsonLang=jsonLang;else{var a=Cookie.read("DHLangCookie30");new Request.JSON({async:!1,url:"/current_config/preLanguage?"+(new Date).getTime(),onSuccess:function(a){var b=a.PreLanguage.replace(/.txt/g,""),c="/web_lang/"+b+".txt",d="/custom_lang/"+b+".txt",e=g_langHashTr.get(b),f="/web_lang/"+e+".txt",g="/custom_lang/"+e+".txt";null==e?getLangFile(c)||getLangFile(d):getLangFile(f)||getLangFile(g)||getLangFile(c)||getLangFile(d)},onFailure:function(){a="../strings/Portugal.txt",getLangFile(a)},onException:function(){a="../debug/English.txt",getLangFile(a)}}).get()}}function getLangFile(a){{var b=!1;new Request.JSON({async:!1,url:a,onSuccess:function(c){Cookie.write("DHLangCookie30",a,{duration:0,path:"/"}),jsonLang=c,b=!0},onFailure:function(){},onException:function(){}}).get()}return b}function tl(a){var b=jsonLang||parent.jsonLang;return b&&b[a]?b[a].trim()?b[a].trim():a:b&&b[a+" "]?b[a+" "]:a}function getLocalPngHash(){new Request({url:"/local.png",async:!1,onSuccess:function(a){var b=a.split("\n");b.filter(function(a){if(""!=a.trim()&&a.test("=","i")){var b=a.split("=");localPngHash.include(b[0].trim(),b[1].trim())}})},onFailure:function(){},onException:function(){}}).get()}function isEnable(a){var b=localPngHash.get(a)-0;return b?b:!1}function postConfig(a,b,c,d,e,f){var g=!0;void 0==e&&(e=!0);var h=function(a){if(checkPostResult(a)){if(g=!0,void 0!=d&&"array"==$type(d))for(var e=0;e<d.length;e++)d[e]=$unlink(b[e]);remarkDisplay(c,tl("com_msg.Save succeeded"),3e3,0)}else g=!1,remarkDisplay(c,tl("com_msg.Save failed"),3e3,1)},i=ConfigManager.instance();return i.setConfig(a,b,h,e,f),g}function postChannelConfig(a,b,c,d,e){var f=!1;void 0==e&&(e=!0);var g=function(a){if(checkPostResult(a)){if(f=!0,void 0!=d&&"array"==$type(d))for(var e=0;e<d.length;e++)d[e]=$unlink(b[e]);remarkDisplay(c,tl("com_msg.Save succeeded"),3e3,0)}else f=!1,remarkDisplay(c,tl("com_msg.Save failed"),3e3,1)},h=new ConfigManager;if("array"==$type(a)){for(var i=[],j=0,k=a.length;k>j;j++){var l=b[j].configFilter();i.include(h.getRequest("configManager.setChannelConfig",'{"name":"'+a[j]+'","table":'+JSON.encode(l[1])+',"channels": '+JSON.encode(l[0])+', "options":""}'))}(new RPCCall).doMutiCall(i.join(","),g,e)}else{var l=b.configFilter();h.setChannelConfig(a,l[0],l[1],g,e)}return f}function refreshConfig(a,b,c,d,e){var f=!0;void 0==d&&(d=!0);var g=function(a,d){checkPostResult(a)?(f=!0,remarkDisplay(b,tl("com_msg.Operateingsuccess"),3e3,0),c(a,d)):(f=!1,remarkDisplay(b,tl("com_msg.Operateingfailure"),3e3,1))},h=ConfigManager.instance();return h.getConfig(a,g,d,e),f}function getDefaultConfig(a,b,c,d){var e=!0;void 0==d&&(d=!0);var f=function(a,d){checkPostResult(a)?(e=!0,remarkDisplay(b,tl("com_msg.Defaultsuccess"),3e3,0),c(a,d)):(e=!1,remarkDisplay(b,tl("com_msg.Defaultfailure"),3e3,1))},g=ConfigManager.instance();return g.getDefault(a,f,d),e}function postConfigEx(a,b,c,d,e,f,g){var h=!0;void 0==f&&(f=!0);var i=function(a){if(checkPostResult(a)){if(h=!0,void 0!=e&&"array"==$type(e))for(var b=0;b<e.length;b++)e[b]=$unlink(c[b]);remarkDisplay(d,tl("com_msg.Save succeeded"),3e3,0)}else h=!1,remarkDisplay(d,tl("com_msg.Save failed"),3e3,1)},j=ConfigManager.instance();return j.setConfigEx(a,b,c,i,f,g),h}function refreshConfigEx(a,b,c,d,e,f){var g=!0;void 0==e&&(e=!0);var h=function(a){checkPostResult(a)?(g=!0,remarkDisplay(c,tl("com_msg.Operateingsuccess"),3e3,0),d(a)):(g=!1,remarkDisplay(c,tl("com_msg.Operateingfailure"),3e3,1))},i=ConfigManager.instance();return i.getConfigEx(a,b,h,e,f),g}function getDefaultConfigEx(a,b,c,d,e){var f=!0;void 0==e&&(e=!0);var g=function(a){checkPostResult(a)?(f=!0,remarkDisplay(c,tl("com_msg.Defaultsuccess"),3e3,0),d(a)):(f=!1,remarkDisplay(c,tl("com_msg.Defaultfailure"),3e3,1))},h=ConfigManager.instance();return h.getDefaultEx(a,b,g,e),f}function getDefaultConfigByCh(a,b,c,d,e){var f=!0;void 0==e&&(e=!0);var g=function(a,b){checkPostResult(a)?(f=!0,remarkDisplay(c,tl("com_msg.Defaultsuccess"),3e3,0),d(a,b)):(f=!1,remarkDisplay(c,tl("com_msg.Defaultfailure"),3e3,1))},h=ConfigManager.instance();return h.getDefaultByCh(a,b,g,e),f}function createDiv(a,b,c,d){var e=parent.jsonWebCaps.customScheduleColor;4==c&&(c=3),5==d&&(d=4);var f=[e&&e.general||"#00FF00",e&&e.motion||"#FFFF00",e&&e.alarm||"#FF0000",e&&e.motAndAlm||"#0080C0","#FF9700"];void 0==d&&(d=4);var g=22*(a[1]+a[2]/60+a[3]/3600)+1,h=22*(a[4]+a[5]/60+a[6]/3600)+1,i="string"==typeof f[c]?f[c]:"RGB("+f[c].toString()+")";if(isIE9){var j=document.createElement("div");j.setAttribute("id","tstt"+b+"_"+c);var k=g+"px",l=10*b*d+10*c+1+"px",m=(h-g>0?h-g:0)+"px",n=i;j.setAttribute("style","height:10px;zIndex:10;position:absolute;border:0px solid #fff;overflow:hidden;width:"+m+"; top:"+l+";left:"+k+";background:"+n+";")}else{var j=new Element("div",{id:"tstt"+b+"_"+c,styles:{"z-index":10,background:i,height:"10px",position:"absolute",border:"0px solid #fff",overflow:"hidden"}}),g=22*(a[1]+a[2]/60+a[3]/3600)+1,h=22*(a[4]+a[5]/60+a[6]/3600)+1;j.style.left=g+"px",j.style.top=10*b*d+10*c+1+"px",j.style.width=(h-g>0?h-g:0)+"px"}return j}function chk10(a){var b=a-0;return 10>a-0?"0"+(b-0):b}function intLimit(a){$(a).value=$(a).value.replace(/[^\d]/g,"")-0}function attachLimit(a,b,c,d){var e=$(a);void 0!=d&&e.setProperty("maxlength",d),e.addEvents({keyup:function(){limit(this,c)},blur:function(){limit(this,c),limitMin(this,b)}})}function attachLimitEx(a,b,c,d){var e="array"===$type(a)?a:$(a);e&&(void 0!=d&&e.setProperty("maxlength",d),e.removeEvents("keyup"),e.removeEvents("blur"),e.addEvents({keyup:function(a){"backspace"!=a.key&&"left"!=a.key&&"right"!=a.key&&(this.value=this.value-0,limit(this,c))},blur:function(){this.value=this.value-0,limit(this,c),limitMin(this,b)},beforepaste:function(){pasteLimit(a,c)}}))}function attachPortLimitEx(a,b,c,d,e){var f=[123,1900,3800,5e3,5050,9999,39999,37810];void 0==d&&(d=1024),void 0==e&&(e=65535),void 0!=c&&f.erase(c);var g=$(a);g.setProperty("maxlength",e.toString().length),g.addEvents({keyup:function(a){"backspace"!=a.key&&"left"!=a.key&&"right"!=a.key&&(this.value=this.value-0,this.value!=c&&limit(this,e))},blur:function(){if(this.value=this.value.replace(/[^\d]/g,""),isNaN(this.value)||""==this.value)$(b)?remarkDisplay(b,tl("com_msg.onlyNumber"),3e3,1):alert(tl("com_msg.onlyNumber"));else{var a=this.value-0;a!=c&&d>a?this.value=d:a!=c&&f.contains(a)?($(b)?remarkDisplay(b,tl("com_msg.portInUse"),3e3,2):alert(tl("com_msg.portInUse")),this.value=d):$(b)&&($(b).style.display="none")}}})}function chkPort(a,b){var c=[123,1900,3800,5e3,5050,9999,39999,37810];return void 0!=b&&c.erase(b),a-0==b||a-0>1024&&!c.contains(a-0)?!0:!1}function attachIpInput(a){var b=new Array;b="array"!=$type(a)?[$(a+"0"),$(a+"1"),$(a+"2"),$(a+"3")]:[$(a[0]),$(a[1]),$(a[2]),$(a[3])];var c=function(a,c){b[a]&&(b[a].setProperty("maxlength",3),b[a].addEvents({keyup:function(d){var e=d.code;if(this.value=this.value-0,limit(this,c),110==e||190==e||39==e)return void(3>a&&b[a+1].select());if(9!=e){if(37==e)return void(a>0&&4>a&&b[a-1].select());this.value.length>=3&&3>a&&(this.value=this.value-0,b[a+1].select()),this.value.length>=3&&3==a&&(this.value=this.value-0,b[0].select())}},blur:function(){""==this.value&&(this.value=0),limit(this,c),this.value=this.value-0},focus:function(){this.select()}}))};c(0,255),c(1,255),c(2,255),c(3,255)}function isValidMAC(a){return 12==a.length&&-1!=a.search(/[a-fA-F0-9]{12}/)?!0:!1}function attachMACInput(a){var b=new Array;b="array"!=$type(a)?[$(a+"0"),$(a+"1"),$(a+"2"),$(a+"3"),$(a+"4"),$(a+"5")]:[$(a[0]),$(a[1]),$(a[2]),$(a[3]),$(a[4]),$(a[5])];var c=function(a,b){var c=$(a).value;$(a).value=c.replace(/[^a-fA-F\d]/g,"");var d=parseInt($(a).value-0,16);return d>b?($(a).value=parseInt(b,16),b):parseInt(d,16)},d=function(a,d){b[a]&&(b[a].setProperty("maxlength",2),b[a].addEvents({keyup:function(e){var f=e.code;if(c(this,d),110==f||190==f||39==f)return void(5>a&&b[a+1].select());if(9!=f){if(37==f)return void(a>0&&6>a&&b[a-1].select());this.value.length>=2&&5>a&&(this.value=this.value+"",b[a+1].select()),this.value.length>=2&&5==a&&(this.value=this.value+"",b[0].select())}},blur:function(){""==this.value&&(this.value="00"),c(this,d),this.value=this.value+"",1==this.value.length&&(this.value="0"+this.value)},focus:function(){this.select()}}))};d(0,255),d(1,255),d(2,255),d(3,255),d(4,255),d(5,255)}function attachTimeEvent(a,b,c){void 0==b&&(b=!0),void 0==c&&(c=23);var d=new Array;d="array"!=$type(a)?[$(a+"0"),$(a+"1"),$(a+"2"),$(a+"3"),$(a+"4"),$(a+"5")]:[$(a[0]),$(a[1]),$(a[2]),$(a[3]),$(a[4]),$(a[5])];var e=function(a,c){d[a]&&d[a].addEvents({keyup:function(b){if("right"==b.key)return void(5>a&&d[a+1].select());if(37==b.code)return void(a>0&&6>a&&d[a-1].select());if("tab"!=b.key){limit(this,c);var e=a>2?3:0;"24"==d[e].value&&(d[e+1].value="00",d[e+2].value="00"),this.value.length>=2&&5>a&&d[a+1].select()}},blur:function(){var a=60*(60*(d[0].value-0)+(d[1].value-0))+(d[2].value-0),c=60*(60*(d[3].value-0)+(d[4].value-0))+(d[5].value-0);if(b&&a>c){var e=d[3].value,f=d[4].value,g=d[5].value;d[3].value=d[0].value,d[4].value=d[1].value,d[5].value=d[2].value,d[0].value=e,d[1].value=f,d[2].value=g}this.value=chk10(this.value)},focus:function(){this.select()}})};e(0,c),e(1,59),e(2,59),e(3,c),e(4,59),e(5,59)}function attachTimeEventEx(a,b,c){void 0==b&&(b=!0);var d=new Array;d="array"!=$type(a)?[$(a+"0"),$(a+"1"),$(a+"2"),$(a+"3")]:[$(a[0]),$(a[1]),$(a[2]),$(a[3])];var e=function(a,e){d[a].setProperty("maxlength",2),d[a]&&d[a].addEvents({keyup:function(b){if("right"==b.key)return void(3>a&&d[a+1].select());if(37==b.code)return void(a>0&&4>a&&d[a-1].select());if("tab"!=b.key){limit(this,e);var c=a>1?2:0;"24"==d[c].value&&(d[c+1].value="00"),this.value.length>=2&&3>a&&d[a+1].select()}},blur:function(){limit(this,e);var f=a>1?2:0;"24"==d[f].value&&(d[f+1].value="00");var g=60*(d[0].value-0)+(d[1].value-0),h=60*(d[2].value-0)+(d[3].value-0);if(b&&g>h){var i=d[2].value,j=d[3].value;d[2].value=d[0].value,d[3].value=d[1].value,d[0].value=i,d[1].value=j}for(var k=0;4>k;++k)d[k].value=chk10(d[k].value);void 0!=c&&c()},focus:function(){this.select()}})};e(0,24),e(1,59),e(2,24),e(3,59)}function getFrame(a,b,c){void 0==c&&(c=!1);var d;return d=c?a+"x"+b:a+"*"+b,"704*576"==d||"704*480"==d?"D1":"352*576"==d||"352*480"==d?"HD1":"704*288"==d||"704*240"==d?"BCIF":"352*288"==d||"352*240"==d?"CIF":"176*144"==d||"176*120"==d?"QCIF":"640*360"==d?"NHD":"640*480"==d?"VGA":"320*240"==d?"QVGA":"480*480"==d?"SVCD":"160*128"==d?"QQVGA":"800*592"==d?"SVGA":"800*600"==d?"SVGA1":"1024*768"==d?"XVGA":"1280*800"==d?"WXGA":"1280*1024"==d?"SXGA":"1600*1024"==d?"WSXGA":"1600*1200"==d?"UXGA":"1920*1200"==d?"WUXGA":"240*192"==d?"ND1":"1280*720"==d?"720P":"960*1080"==d?"1080N":"1920*1080"==d?"1080P":"960*576"==d||"960*480"==d?"960H":"1280*960"==d?"1.3M":"1872*1408"==d?"2.5M":"3744*1408"==d?isIPC?"5_1M":"5M":"2560*1920"==d?"5M":"2048*1536"==d?"3M":"3840*2160"==d?"QFHD":"2560*1600"==d?"4M":"2560*1440"==d?"2K":"3840*2160"==d?"4K":c?a+"x"+b:a+"*"+b}function getWidthH(a,b,c){if(void 0==b&&(b=!1),void 0==c&&(c=PAL_NTSC),isIPC)var d=["D1","HD1","2CIF","CIF","QCIF","VGA","QVGA","SVCD","QQVGA","SVGA","XVGA","WXGA","SXGA","WSXGA","UXGA","WUXGA","ND1","720","1080","1.3M","2.5M","5_1M","3M","1_2M","1_5M","8M","5M","4M","1080N","2K","4K"];else var d=["960H","D1","HD1","2CIF","CIF","QCIF","VGA","QVGA","SVCD","QQVGA","SVGA","XVGA","WXGA","SXGA","WSXGA","UXGA","WUXGA","ND1","720","1080","1.3M","2.5M","5M","3M","1_2M","1_5M","8M","5_1M","NHD","SVGA1","FWVGA","DVGA","WXGA2","WXGA3","WXGA4","SXGA+","QFHD","DV720P","BCIF","1080N","2K","4K"];var e=["960*576","704*576","352*576","704*288","352*288","176*144","640*480","320*240","480*480","160*128","800*592","1024*768","1280*800","1280*1024","1600*1024","1600*1200","1920*1200","240*192","1280*720","1920*1080","1280*960","1872*1408","3744*1408","2048*1536","1216*1024","1408*1024","3296*2472","2560*1920","640*360","800*600","854*480","960*640","1280*768","1280*854","1366*768","1400*1050","3840*2160","960*720","704*288","960*1080","2560*1440","3840*2160"],f=["960*480","704*480","352*480","704*240","352*240","176*120","640*480","320*240","480*480","160*128","800*592","1024*768","1280*800","1280*1024","1600*1024","1600*1200","1920*1200","240*192","1280*720","1920*1080","1280*960","1872*1408","3744*1408","2048*1536","1216*1024","1408*1024","3296*2472","2560*1920","640*360","800*600","854*480","960*640","1280*768","1280*854","1366*768","1400*1050","3840*2160","960*720","704*240","960*1080","2560*1440","3840*2160"];"720P"==a&&(a="720"),"1080P"==a&&(a="1080"),("1280x960"==a||"1_3M"==a)&&(a="1.3M"),"1872x1408"==a&&(a="2.5M"),"5.1M"==a&&(a="5_1M");var g=d.indexOf(a);if(0>g){var h;return h=a.split(b?"x":"*"),h[0]+"*"+h[1]}return"PAL"==c?e[g]:f[g]}function sortResolutionByNumber(a){return a.sort(function(a,b){var c=a.split("*"),d=b.split("*"),e=(c[0]-0)*(c[1]-0),f=(d[0]-0)*(d[1]-0);return f>e?1:e==f&&c[0]-0>c[1]-0?1:-1}),a}function sortResolutionByString(a,b){return a.sort(function(a,c){var d=a.contains("x")?!0:!1,e=getWidthH(a,d,b).split("*"),f=c.contains("x")?!0:!1,g=getWidthH(c,f,b).split("*"),h=(e[0]-0)*(e[1]-0),i=(g[0]-0)*(g[1]-0);return i>h?1:h==i&&e[0]-0>e[1]-0?1:-1}),a}function checkPostResult(a){if(JSON.decode(a).result){var b=JSON.decode(a).params;if("array"==$type(b)){for(var c=0;c<b.length;c++){if(void 0==b[c].result)return!0;if(!b[c].result)return!1}return!0}return!0}return!1}function checkAll(a,b,c){for(var d=document.getElementById(a),e=document.getElementById(c).getElementsByTagName("input"),f=0,g=0,h=0;h<e.length;h++)"checkbox"==e[h].type&&(d==b?e[h].checked=b.checked:e[h].checked&&e[h].id!=a&&g++,e[h].id!=a&&f++);d!=b&&(d.checked=f==g)}function getSelect(a){var b=$(a);return-1!=b.selectedIndex?b.options[b.selectedIndex].text:void 0}function remarkDisplay(a,b,c,d){if($(a)){var e,f=function(a){$(a)&&$(a).fadeOut()};switch(d){case 0:e="success";break;case 1:e="error";break;case 2:e="warning"}$(a).removeClass("ui-tip-success").removeClass("ui-tip-warning").removeClass("ui-tip-error").addClass("ui-tip-"+e).setStyle("display","block"),$(a).fadeIn(),$(a).getElement("label").setProperty("text",b),c&&window.setTimeout(function(){f(a)},c)}}function getMonthDays(a,b){function c(a){return a%100==0&&a%400==0||a%100!=0&&a%4==0?!0:!1}return 4==b||6==b||9==b||11==b?30:2==b&&c(a)?29:2!=b||c(a)?31:28}function attachDateInput(a,b){var c=new Array,d=new Array;c=[$(a+"0"),$(a+"1"),$(a+"2")],d=[$(b+"0"),$(b+"1"),$(b+"2")];var e=function(b,e){c[b]&&c[b].addEvents({keyup:function(f){if(2==b){var g=getMonthDay(a);chkTime(a,b,g,f)}else chkTime(a,b,e,f);var h=f.code;return 37==h?void(b>0&&3>b?c[b-1].select():0==b&&null!=d[2]&&d[2].select()):void(2==b&&null!=d[0]&&this.value.length>=2&&9!=h&&window.setTimeout(function(){d[0].select()},100))},blur:function(){this.value=this.value.replace(/[^\d]/g,""),checkDay(a)},focus:function(){this.select()}})},f=function(a,e){d[a]&&d[a].addEvents({keyup:function(f){chkTime(b,a,e,f);var g=f.code;return 37==g?0==a&&null!=c[2]?void c[2].select():void(a>0&&3>a&&d[a-1].select()):39==g&&2==a&&null!=c[0]?void c[0].select():void 0},blur:function(){var a=this.value-0;this.value=this.value.replace(/[^\d]/g,""),0>=a?this.value="00":10>a?this.value="0"+a:a>e?this.value=e:isNaN(a)&&(this.value="00")},focus:function(){this.select()}})};""!=a&&(e(0,2037),e(1,12),e(2,getMonthDay(a))),""!=b&&(f(0,23),f(1,59),f(2,59))}function clickElement(a){if(document.all)a.click();else{var b=document.createEvent("MouseEvents");b.initEvent("click",!0,!0),a.dispatchEvent(b)}}function openHelp(a){"SimpChinese"==curLang&&window.open("/help/SimpChinese/"+a,"help"+Cookie.read("DhWebClientSessionID"),"width=601,height=500,menubar=no,status=no,toolbar=no,location=no,scrollbars=yes,resizable=yes"),"English"==curLang?window.open("/help/English/"+a,"help"+Cookie.read("DhWebClientSessionID"),"width=601,height=500,menubar=no,status=no,toolbar=no,location=no,scrollbars=yes,resizable=yes"):window.open("/help/SimpChinese/"+a,"help"+Cookie.read("DhWebClientSessionID"),"width=601,height=500,menubar=no,status=no,toolbar=no,location=no,scrollbars=yes,resizable=yes")}function round1(a,b){var c=(a.toInt()%b.toInt()).toInt();return c<(b/2).toInt()?a.toInt()-c:a.toInt()+b.toInt()-c}function getReference(a,b,c,d,e,f){void 0==f&&(f=!0);var g,h;1>b&&(b=1);var i=b>149?50:b,j=a;f?i=50:(i=2*(j-0),i>149&&(i=50));var k=(i+3-1)*j*7;f||"MJPEG"!=e&&"MJPG"!=e||(k=(i+3-1)*j*7*3);var l=i;return g="PAL"==PAL_NTSC||"HI3520A"==g_processor||"HI3521"==g_processor||"HI3531"==g_processor||isHDCVI?(k/l).toInt()*c*d/101376:(k/l).toInt()*c*d/84480,g>=4&&(g=round1(g,(1<<(Math.log(g)/Math.log(2)).toInt())/4)),k=(i+3-1)*j*40,l=i,h="PAL"==PAL_NTSC||"HI3520A"==g_processor||"HI3521"==g_processor||"HI3531"==g_processor||"DM810x"==g_processor||"DM814x"==g_processor||isHDCVI?(k/l).toInt()*c*d/101376:(k/l).toInt()*c*d/84480,h>=4&&(h=round1(h,(1<<(Math.log(h)/Math.log(2)).toInt())/4)),!f||"MJPEG"!=e&&"MJPG"!=e||(h*=3),"MJPEG"!=e&&"MJPG"!=e&&(h>8192&&(h=8192),g>8192&&(g=8192)),g>h&&(g=h),[g.toInt(),h.toInt()]}function isNeedReboot(a,b,c,d,e,f){var g=!1;if(JSON.decode(a).result){var h=JSON.decode(a).params;if("array"==$type(h))for(var i=0;i<h.length;i++)"array"==$type(h[i].params.options)&&(h[i].params.options.contains("NeedReboot")||h[i].params.options.contains("NeedRestart"))&&(g=!0);else"array"==$type(h.options)&&(h.options.contains("NeedReboot")||h.options.contains("NeedRestart"))&&(g=!0);g&&needReboot(b,c,d,e,f)}}function needReboot(a,b,c,d,e,f,g){if(void 0==d&&(d=400),void 0==e&&(e=200),void 0==f&&(f=!1),$("spe_isForNeedRbootId")&&$("spe_isForNeedRbootId").destroy(),isIE9){var h=document.createElement("div");h.setAttribute("id","spe_isForNeedRbootId")}else var h=new Element("div",{id:"spe_isForNeedRbootId"});$("cmaincont").appendChild(h),$("spe_isForNeedRbootId").innerHTML="";var i='<div id="spe_showRebootDialog" class="ui-dialog"><div class="ui-dialog-title"><h1>title</h1><a class="ui-dialog-icon"></a></div><div class="ui-dialog-container" ><div class="ui-dialog-content"><i class="ui-dialog-surebox-icon"></i>'+tl(a)+'</div><div class="ui-button-box fn-padt10"><a id="spe_sureRebootButton" href="javascript:;" class="ui-button">'+tl("com_button.yes")+'</a><a id="spe_cancelRebootButton" href="javascript:;" class="ui-button">'+tl("com_button.no")+"</a></div></div></div>";$("spe_isForNeedRbootId").innerHTML=i,void 0==g?(spe_rebootDialog=new Dialog("spe_showRebootDialog",spe_IsNeedRebootFunc,"spe_sureRebootButton","spe_cancelRebootButton",tl("com_button.reboot")),spe_rebootDialog.setPosition(d-150,e),spe_rebootDialog.show(),c&&($("spe_cancelRebootButton").style.display=""),b?$("spe_sureRebootButton").style.display="":($("spe_cancelRebootButton").style.display="none",setTimeout("spe_IsNeedRebootFunc()",5e3))):(spe_rebootDialog=new Dialog("spe_showRebootDialog",g,"spe_sureRebootButton","spe_cancelRebootButton",tl("com_button.reboot")),spe_rebootDialog.setPosition(d-150,e),spe_rebootDialog.show(),c&&($("spe_cancelRebootButton").style.display=""),b?$("spe_sureRebootButton").style.display="":($("spe_cancelRebootButton").style.display="none",setTimeout("yesFun()",5e3))),f&&($("spe_cancelRebootButton").setProperty("text",tl("com_button.remindLater")),setTimeout(function(){needReboot(a,b,c,d,e,f)},2e4))}function spe_IsNeedRebootFunc(){var a=$("spe_sureRebootButton");a&&"block"==a.style.display&&$("spe_isForNeedRbootId").destroy(),rebootAndLocate()}function locate2Homepage(a){if(void 0==a&&(a=!0),a)parent.exit2LoginPage&&parent.exit2LoginPage(),0==hasAlertReboot&&(hasAlertReboot=!0,alert(tl("com_msg.rebooting")));else{var b=location.href.split("/"),c=b[0]+"//"+b[2]+"/index.htm";parent.location.replace(c)}}function rebootAndLocate(a){"number"!=$type(a)&&(a=1e3),parent.g_ocx.LogoutDevice(),parent.clearInterval(parent.g_timerAlive);var b=new MagicBox;b.reboot(),setTimeout("locate2Homepage()",a)}function nameImportLimt(a,b,c){var d=$(a).value;return $(b).setProperty("text",""),/^[\w-]+$/.test(d)?void $(b).setProperty("text",""):void $(b).setProperty("text",tl(c))}function nameImportLimtEx(a,b,c){var d=$(a).value;return $(b).setProperty("text",""),/^[\w-.]+$/.test(d)?void $(b).setProperty("text",""):void $(b).setProperty("text",tl(c))}function NumberImportLimt(a,b,c){var d=$(a).value;return $(b).setProperty("text",""),/^[\w-#*]+$/.test(d)?void $(b).setProperty("text",""):void $(b).setProperty("text",tl(c))}function promptImportLimt(a,b,c,d){var e=$(a).value;$(b).setProperty("text","");var f=!1;switch(d){case 0:/^[\w-]+$/.test(e)||(f=!0);break;case 1:/^[\w-.]+$/.test(e)||(f=!0);break;case 2:/^[\w-#*]+$/.test(e)||(f=!0);break;case 3:(/[\"]+/.test(e)||/[\']+/.test(e))&&(f=!0);break;case 4:/[\"*<>?|\/]+/.test(e)&&(f=!0);break;case 5:(/[\"]+/.test(e)||/[\']+/.test(e)||/[\u4E00-\u9FA5]+/.test(e))&&(f=!0);break;case 6:(/[\"]+/.test(e)||/[\']+/.test(e)||/[\u4E00-\u9FA5]+/.test(e)||/\s/.test(e))&&(f=!0);break;case 7:/^[\w-]+@[\w-]+\.{1}[\w-]+$/.test(e)||(f=!0);break;case 8:/^[\w]+$/.test(e)||(f=!0);break;case 9:/^[a-z0-9A-Z]*$/.test(e)||(f=!0)}f?$(b).setProperty("text",tl(c)):$(b).setProperty("text","")}function checkedImportLimtEx(a,b,c){var d=$(a).value;if(void 0==c&&(c=1),0==d.length&&0==c)return!1;if(0==d.length&&1==c)return!0;var e=!1;switch(b){case 0:/[\s\w-!?@#$%^+*|:,.]/.test(d)||(e=!0),/[\u4E00-\u9FA5]/.test(d)&&(e=!0);break;case 1:/[\s\w-!?@#$%^+*|:,.\u4E00-\u9FA5]/.test(d)||(e=!0)}return e?!1:!0}function attachLimitInput(a,b,c,d){var e=$(a);e.removeEvents("keyup"),e.removeEvents("blur"),e.addEvents({keyup:function(){0==checkedImportLimtEx(a,b,c)&&(this.value="",""!=d&&remarkDisplay(d,tl("com_msg.canOnlyDevSign"),3e3,1))},blur:function(){0==checkedImportLimtEx(a,b,c)&&(this.value="",""!=d&&remarkDisplay(d,tl("com_msg.canOnlyDevSign"),3e3,1))}})}function checkedImportLimt(a,b){var c=$(a).value,d=!1;switch(b){case 0:/^[\w-]+$/.test(c)||(d=!0);break;case 1:/^[\w-.]+$/.test(c)||(d=!0);break;case 2:/^[\w-#*]+$/.test(c)||(d=!0);break;case 3:(/[\"]+/.test(c)||/[\']+/.test(c))&&(d=!0);break;case 4:/[\"*<>?|\/]+/.test(c)&&(d=!0);break;case 5:(/[\"]+/.test(c)||/[\']+/.test(c)||/[\u4E00-\u9FA5]+/.test(c))&&(d=!0);break;case 6:(/[\"]+/.test(c)||/[\']+/.test(c)||/[\u4E00-\u9FA5]+/.test(c)||/\s/.test(c))&&(d=!0);break;case 7:/^[\w-.]+@[\w-]+\.{1}[\w-]+$/.test(c)||(d=!0);break;case 8:/^[\w]+$/.test(c)||(d=!0);break;case 9:/^[a-z0-9A-Z]*$/.test(c)||(d=!0);break;case 10:/^[\w-.+,]+$/.test(c)||/[\u4E00-\u9FA5]+/.test(c)||(d=!0);break;case 11:/[\s\w-!+=?@#$%^&*|/,.]/.test(c)||(d=!0)}return d?!1:!0}function estopPage(){var a=parent.document.documentElement.clientHeight,b=parent.document.documentElement.clientWidth,c=parent.document.body.offsetHeight,d=c>a?c:a,e=parent.document.getElementById("estopAll");e.style.height=d+"px",e.style.width=b+"px",e.style.display="block"}function cLength(a){var b=/([0-9a-f]{1,4}:)|(:[0-9a-f]{1,4})/gi,c=a.replace(b," ");return c.length}function isIPv6(a){return checkIPv6(a)}function checkIPv6(a){var b=/^(([a-f\d]{1,4}:){7}([a-f\d]{1,4}){1})$/gi.test(a)||/^(([a-f\d]{1,4}:){1}(:[a-f\d]{1,4}){1,6})$/gi.test(a)||/^(([a-f\d]{1,4}:){2}(:[a-f\d]{1,4}){1,5})$/gi.test(a)||/^(([a-f\d]{1,4}:){3}(:[a-f\d]{1,4}){1,4})$/gi.test(a)||/^(([a-f\d]{1,4}:){4}(:[a-f\d]{1,4}){1,3})$/gi.test(a)||/^(([a-f\d]{1,4}:){5}(:[a-f\d]{1,4}){1,2})$/gi.test(a)||/^(([a-f\d]{1,4}:){6}(:[a-f\d]{1,4}){1})$/gi.test(a)||/^(:(:[a-f\d]{1,4}){1,7})$/gi.test(a)||/^(([a-f\d]{1,4}:){1,7}:)$/gi.test(a)||/^(::)$/g.test(a)||/^(::([\d]{1,3}.){3}([\d]{1,3}){1})$/gi.test(a)||/^(::ffff:([\d]{1,3}.){3}([\d]{1,3}){1})$/gi.test(a)||/^(([0]{1,4}:){5}ffff:([\d]{1,3}.){3}([\d]{1,3}){1})$/gi.test(a)||/^(([0]{1,4}:){0,3}([0]{1,4}){1}::ffff:([\d]{1,3}.){3}([\d]{1,3}){1})$/gi.test(a)||/^(([0]{1,4}:){1}(:[0]{1,4}){1,3}:ffff:([\d]{1,3}.){3}([\d]{1,3}){1})$/gi.test(a)||/^(([0]{1,4}:){2}(:[0]{1,4}){1,2}:ffff:([\d]{1,3}.){3}([\d]{1,3}){1})$/gi.test(a)||/^(([0]{1,4}:){3}(:[0]{1,4}){1}:ffff:([\d]{1,3}.){3}([\d]{1,3}){1})$/gi.test(a)||/^(:(:[0]{1,4}){1,4}:ffff:([\d]{1,3}.){3}([\d]{1,3}){1})$/gi.test(a);return b&&!(/^(::)$/g.test(a)||/^(:(:[0]{1,4}){1,7})$/g.test(a)||/^(([0]{1,4}:){7}([0]{1,4}){1})$/g.test(a)||/^(([0]{1,4}:){1}(:[0]{1,4}){1,6})$/g.test(a)||/^(([0]{1,4}:){2}(:[0]{1,4}){1,5})$/g.test(a)||/^(([0]{1,4}:){3}(:[0]{1,4}){1,4})$/g.test(a)||/^(([0]{1,4}:){4}(:[0]{1,4}){1,3})$/g.test(a)||/^(([0]{1,4}:){5}(:[0]{1,4}){1,2})$/g.test(a)||/^(([0]{1,4}:){6}(:[0]{1,4}){1})$/g.test(a)||/^(([0]{1,4}:){1,7}:)$/g.test(a)||/^((::[0]{0,3}1){1})$/g.test(a)||/^(:(:[0]{1,4}){1,6}(:[0]{0,3}1){1})$/g.test(a)||/^(([0]{1,4}:){7}([0]{0,3}1){1})$/g.test(a)||/^(([0]{1,4}:){1}(:[0]{1,4}){0,5}(:[0]{0,3}1){1})$/g.test(a)||/^(([0]{1,4}:){2}(:[0]{1,4}){0,4}(:[0]{0,3}1){1})$/g.test(a)||/^(([0]{1,4}:){3}(:[0]{1,4}){0,3}(:[0]{0,3}1){1})$/g.test(a)||/^(([0]{1,4}:){4}(:[0]{1,4}){0,2}(:[0]{0,3}1){1})$/g.test(a)||/^(([0]{1,4}:){5}(:[0]{1,4}){0,1}(:[0]{0,3}1){1})$/g.test(a)||/^(([0]{1,4}:){6}(:[0]{1,4}){0}(:[0]{0,3}1){1})$/g.test(a)||/^((ff[a-f\d]{2}){1}(:[a-f\d]{1,4}){7})$/gi.test(a)||/^((ff[a-f\d]{2}:){1}(:[a-f\d]{1,4}){1,6})$/gi.test(a)||/^((ff[a-f\d]{2}:){1}([a-f\d]{1,4}:){1}(:[a-f\d]{1,4}){1,5})$/gi.test(a)||/^((ff[a-f\d]{2}:){1}([a-f\d]{1,4}:){2}(:[a-f\d]{1,4}){1,4})$/gi.test(a)||/^((ff[a-f\d]{2}:){1}([a-f\d]{1,4}:){3}(:[a-f\d]{1,4}){1,3})$/gi.test(a)||/^((ff[a-f\d]{2}:){1}([a-f\d]{1,4}:){4}(:[a-f\d]{1,4}){1,2})$/gi.test(a)||/^((ff[a-f\d]{2}:){1}([a-f\d]{1,4}:){5}(:[a-f\d]{1,4}){1})$/gi.test(a)||/^((ff[a-f\d]{2}:){1}([a-f\d]{1,4}:){0,6}:)$/gi.test(a))}function compareIPv6(a,b){if(!isIPv6(a)||!isIPv6(b))return-1;var c=new Array,d=new Array,e="",f="",g=":0000:";if(-1!=a.indexOf(".")&&-1!=b.indexOf(".")){c=a.match(/\d+.\d+.\d+.\d+/g)[0].split("."),d=b.match(/\d+.\d+.\d+.\d+/g)[0].split(".");for(var h=0;4>h;h++){if(c[h]-0<d[h]-0)return 1;if(c[h]-0>d[h]-0)return 2;c[h]-0!=d[h]-0}return 0}if(c=a.split(":"),d=b.split(":"),c.length<8){for(var h=0;h<8-c.length;h++)g+="0000:";e=a.replace(/[:]{2}/g,g)}else{for(var h=0;8>h;h++)""==c[h]&&(c[h]="0000");e=c.join(":")}if(g=":0000:",d.length<8){for(var g=":0000:",h=0;h<8-d.length;h++)g+="0000:";f=b.replace(/[:]{2}/g,g)}else{for(var h=0;8>h;h++)""==d[h]&&(d[h]="0000");f=d.join(":")}c=e.split(":"),d=f.split(":");for(var h=0;8>h;h++){if(parseInt(c[h],16)<parseInt(d[h],16))return 1;if(parseInt(c[h],16)>parseInt(d[h],16))return 2;parseInt(c[h],16)!=parseInt(d[h],16)}return 0}function alertD(a){Dialog.alert(a),setTimeout("closeAlertD(Dialog.AlertNo-1)",1200)}function closeAlertD(a){Dialog.getInstance("_DialogAlert"+a)&&Dialog.getInstance("_DialogAlert"+a).close()}function showDialog(a,b,c,d,e,f){var g='<div class="insbox">				        <h2 class="tith1"><p id="stct" class="titleH">'+a+'</p><p class="exit" id=""><a href="javascript:;"></a></p></h2><div class="con pop_up">';g+=b,g+='<div class="popUpbtn">                <a class="btn_style " href="javascript:;" id="'+f+'_confirm">确定</a>                <a class="btn_style" href="javascript:;" id="'+f+'_close">取消</a>            </div></div></div>';var h=new Element("div",{html:g,"class":"outbox",id:f,styles:{top:"-10000px",width:d+"px",height:e+"px"}});h.inject($("cmaincont"));var i=new Dialog(f,c,f+"_confirm",f+"_close");i.show()}function NoCopyEventHandler(a,b){if(b){if(b.EventHandler){a.EventHandler.RecordChannels=b.EventHandler.RecordChannels,a.EventHandler.RecordLatch=b.EventHandler.RecordLatch,a.EventHandler.SnapshotChannels=b.EventHandler.SnapshotChannels,a.EventHandler.SnapshotTimes=b.EventHandler.SnapshotTimes,a.EventHandler.AlarmOutChannels=b.EventHandler.AlarmOutChannels,a.EventHandler.AlarmOutLatch=b.EventHandler.AlarmOutLatch;var c=a.EventHandler.MonitorTour[0],d=b.EventHandler.MonitorTour[0],e=[];for(var f in c)e.include(f);for(var f in d)e.include(f);e.each(function(c){"Enable"!=c&&(a.EventHandler.MonitorTour[0][c]=b.EventHandler.MonitorTour[0][c],$defined(a.EventHandler.MonitorTour[0][c])||delete a.EventHandler.MonitorTour[0][c])});for(var g in a.EventHandler)$defined(a.EventHandler[g])||delete a.EventHandler[g]}}else{delete a.EventHandler.RecordChannels,delete a.EventHandler.RecordLatch,delete a.EventHandler.SnapshotChannels,delete a.EventHandler.SnapshotTimes,delete a.EventHandler.AlarmOutChannels,delete a.EventHandler.AlarmOutLatch;var h=a.EventHandler.MonitorTour[0];for(var f in h)"Enable"!=f&&delete a.EventHandler.MonitorTour[0][f]}}function showDialogEx(a,b,c,d,e,f){Dialog.getInstance(f).close();var g=new Dialog(f);g.Width=d,g.Height=e;screen.availHeight,screen.availWidth,g.Width,g.Height;g.Title=a,g.innerElementId=b,g.OKEvent=c,g.show()}function hideSelectBoxes(){var a=document.getElementsByTagName("SELECT");for(i=0;a&&i<a.length;i++)a[i].style.visibility="hidden"}function displaySelectBoxes(){var a=document.getElementsByTagName("SELECT");for(i=0;a&&i<a.length;i++)a[i].style.visibility="visible"}function setPosition(){var a=(screen.availHeight,screen.availWidth,$("d").style.width),b=$("d").style.height;a=a.replace(/[^\d]/g,""),b=b.replace(/[^\d]/g,"")}function getValue(a){return $(a).selectedIndex>=0?$(a).options[$(a).selectedIndex].value:""}function getAddDevChannel(a){var b=LogicDeviceManager.instance(),c=null,d=[];if(void 0==a?b.getCameraAll(function(a,b){b.result&&b.params&&b.params.camera&&(c=b.params.camera)},!1):c=a,c)for(var e=CHANNEL_NUMBER-REMOTE_CHANNELS;e<CHANNEL_NUMBER;e++)c[e]&&c[e].Enable?d.include(e):c["uuid:System_CONFIG_NETCAMERA_INFO_"+e]&&c["uuid:System_CONFIG_NETCAMERA_INFO_"+e].Enable&&d.include(e);return d}function getAllChannel(a,b,c,d){if(void 0==b&&(b=!0),void 0==c&&(c=CHANNEL_NUMBER),void 0==d&&(d=[]),a.setProperty("channelnum",c),isIE6){if(a.innerHTML="",0!=d.length)for(e=0;e<d.length;e++)a.options.add(new Option(d[e],d[e]-1));else for(var e=0;c>e;e++)a.options.add(new Option(e+1,e));c>1&&b&&a.options.add(new Option(tl("com_str.comall"),e))}else{a.style.display="none";var f=a.getParent(),g=[];if(g.push('<div class="ui-custom-select"><a class="ui-custom-select-input"><p class="ui-custom-select-inputbox">1</p><i class="ui-custom-select-inputbtn" href="javascript:;"></i></a><div class="ui-custom-select-content fn-clear" style="display:none">'),0!=d.length)for(var h=0;h<d.length;h++)g.push('<a class="ui-channel-item" href="javascript:;">'+d[h]+"</a>");else for(var e=0;c>e;e++)g.push('<a class="ui-channel-item" href="javascript:;">'+(e+1)+"</a>");if(b&&g.push('<a class="ui-channel-item ui-channel-all" href="javascript:;" title="'+tl("com_str.comall")+'">'+tl("com_str.comall")+"</a>"),g.push("</div></div>"),f.innerHTML=g.join(""),a.inject(f),a.innerHTML="",0!=d.length)for(e=0;e<d.length;e++)a.options.add(new Option(d[e],d[e]-1));else for(e=0;c>e;e++)a.options.add(new Option(e+1,e));b&&c>1&&a.options.add(new Option("ALL",e));var i=f.getElement("div[class=ui-custom-select]"),j=f.getElement("a[class=ui-custom-select-input]"),k=i.getElement("div");
j.addEvent("click",function(b){if("none"==k.style.display){{a.getParent()}k.style.display="inline-block"}else k.style.display="none";b.stop()}),k.getElements("a").each(function(b,c){b.addEvent("click",function(){a.selectedIndex=c,k.style.display="none",f.getElement("p").setProperty("text",this.getProperty("text")),a.fireEvent("change")})})}}function getChannel(a,b,c,d,e){var f=0,g=0;if(void 0==b&&(b=!0),void 0==c&&(c=CHANNEL_NUMBER),void 0==d&&(d=!1),e=e||[],""==e?(d||CHANNEL_NUMBER==REMOTE_CHANNELS)&&(g=CHANNEL_NUMBER-REMOTE_CHANNELS,""==g_addDevCh?(g_addDevCh=[],f=-1):f=g_addDevCh[0]>=g?g_addDevCh[0]:g_addDevCh[g]||-1):f=e[0]-1,a.setProperty("channelnum",c),isIE6){a.innerHTML="";var h=0;if(""==e)for(h=g;c>h;h++)(g_addDevCh.contains(h)||h<CHANNEL_NUMBER-REMOTE_CHANNELS)&&a.options.add(new Option(h+1,h));else e.each(function(b){g_addDevCh.contains(b-1)&&a.options.add(new Option(b,b-1))});c>1&&b&&a.options.add(new Option(tl("com_str.comall"),h))}else{a.style.display="none";var i=a.getParent(),j=[];if(j.push(-1==f?'<div class="ui-custom-select"><a class="ui-custom-select-input"><p class="ui-custom-select-inputbox"></p><i class="ui-custom-select-inputbtn" href="javascript:;"></i></a><div class="ui-custom-select-content fn-clear" style="display:none">':'<div class="ui-custom-select"><a class="ui-custom-select-input"><p class="ui-custom-select-inputbox">'+(f+1)+'</p><i class="ui-custom-select-inputbtn" href="javascript:;"></i></a><div class="ui-custom-select-content fn-clear" style="display:none">'),""==e)for(var h=g;c>h;h++)(g_addDevCh.contains(h)||h<CHANNEL_NUMBER-REMOTE_CHANNELS)&&j.push('<a class="ui-channel-item" href="javascript:;">'+(h+1)+"</a>");else e.each(function(a){g_addDevCh.contains(a-1)&&j.push('<a class="ui-channel-item" href="javascript:;">'+a+"</a>")});if(b&&j.push('<a class="ui-channel-item ui-channel-all" href="javascript:;" title="'+tl("com_str.comall")+'">'+tl("com_str.comall")+"</a>"),j.push("</div></div>"),i.innerHTML=j.join(""),a.inject(i),a.innerHTML="",""==e)for(var h=g;c>h;h++)(g_addDevCh.contains(h)||h<CHANNEL_NUMBER-REMOTE_CHANNELS)&&a.options.add(new Option(h+1,h));else e.each(function(b){g_addDevCh.contains(b-1)&&a.options.add(new Option(b,b-1))});b&&c>1&&a.options.add(new Option("ALL",h));var k=i.getElement("div[class=ui-custom-select]"),l=i.getElement("a[class=ui-custom-select-input]"),m=k.getElement("div");l.addEvent("click",function(b){if("none"==m.style.display){{a.getParent()}m.style.display="inline-block"}else m.style.display="none";b.stop()}),m.getElements("a").each(function(b,c){b.addEvent("click",function(){a.selectedIndex=c,m.style.display="none",i.getElement("p").setProperty("text",this.getProperty("text")),a.fireEvent("change")})})}}function getChannelEx(a,b,c){void 0==b&&(b=!0),void 0==c&&(c=CHANNEL_NUMBER);var d=0;if(a.setProperty("channelnum",c),isIE6){a.innerHTML="";var e=0;for(e=d;c>e;e++)a.options.add(new Option(e+1,e));c>1&&b&&a.options.add(new Option(tl("com_str.comall"),e))}else{a.style.display="none";var f=a.getParent(),g=[];g.push('<div class="ui-custom-select"><a class="ui-custom-select-input"><p class="ui-custom-select-inputbox">1</p><i class="ui-custom-select-inputbtn" href="javascript:;"></i></a><div class="ui-custom-select-content fn-clear" style="display:none">');for(var e=d;c>e;e++)g.push('<a class="ui-channel-item" href="javascript:;">'+(e+1)+"</a>");b&&g.push('<a class="ui-channel-item ui-channel-all" href="javascript:;" title="'+tl("com_str.comall")+'">'+tl("com_str.comall")+"</a>"),g.push("</div></div>"),f.innerHTML=g.join(""),a.inject(f),a.innerHTML="";var e=0;for(e=d;c>e;e++)a.options.add(new Option(e+1,e));b&&c>1&&a.options.add(new Option("ALL",e));var h=f.getElement("div[class=ui-custom-select]"),i=f.getElement("a[class=ui-custom-select-input]"),j=h.getElement("div");i.addEvent("click",function(b){if("none"==j.style.display){{a.getParent()}j.style.display="inline-block"}else j.style.display="none";b.stop()}),j.getElements("a").each(function(b,c){b.addEvent("click",function(){a.selectedIndex=c,j.style.display="none",f.getElement("p").setProperty("text",this.getProperty("text")),a.fireEvent("change")})})}}function getRemoteChannel(a,b,c){void 0==b&&(b=!0),void 0==c&&(c=CHANNEL_NUMBER);var d=CHANNEL_NUMBER-REMOTE_CHANNELS;if(isIE6){a.innerHTML="";var e=0;for(e=d;c>e;e++)a.options.add(new Option(e+1,e));c>1&&b&&a.options.add(new Option(tl("com_str.comall"),e))}else{a.style.display="none";var f=a.getParent(),g=[];g.push('<div class="ui-custom-select"><a class="ui-custom-select-input"><p class="ui-custom-select-inputbox">'+(d+1)+'</p><i class="ui-custom-select-inputbtn" href="javascript:;"></i></a><div class="ui-custom-select-content fn-clear" style="display:none">');for(var e=d;c>e;e++)g.push('<a class="ui-channel-item" href="javascript:;">'+(e+1)+"</a>");b&&g.push('<a class="ui-channel-item" href="javascript:;" title="'+tl("com_str.comall")+'">'+tl("com_str.comall")+"</a>"),g.push("</div></div>"),f.innerHTML=g.join(""),a.inject(f),a.innerHTML="";var e=0;for(e=d;c>e;e++)a.options.add(new Option(e+1,e));c>1&&a.options.add(new Option("ALL",e));var h=f.getElement("div[class=ui-custom-select]"),i=f.getElement("a[class=ui-custom-select-input]"),j=h.getElement("div");i.addEvent("click",function(b){if("none"==j.style.display){{a.getParent()}j.style.display="inline-block"}else j.style.display="none";b.stop()}),j.getElements("a").each(function(b,c){b.addEvent("click",function(){a.selectedIndex=c,a.fireEvent("change"),j.style.display="none",f.getElement("p").setProperty("text",this.getProperty("text"))})})}}function checkIP(a,b){var c,d=$(a+b),e=event.keyCode;return d.value=d.value.replace(/[^\d]/g,""),110==e&&(e=39),37==e||39==e||9==e?(""==d.value&&(d.value=0),d.blur(),37==e&&(c=b-1),39==e&&(c=b+1),9==e&&(c=b),c=c>=4?3:c,c=0>c?3:c,void $(a+c).select()):void(d.value.length>=3&&(parseInt(d.value)>=256?(d.value=255,c=b+1,c=c>=4?3:c,c=0>c?3:c,$(a+c).select()):parseInt(d.value)<0?d.value=0:(d.blur(),c=b+1,c=c>=4?3:c,c=0>c?3:c,$(a+c).select())))}function pasteChk(){clipboardData.setData("text",clipboardData.getData("text").replace(/[^\d]/g,""))}function pasteLimit(a,b){var c=clipboardData.getData("text");c=c.replace(/[^\d]/g,"");var d=c-0;d>b?($(a).value=b,clipboardData.setData("text",""+b)):clipboardData.setData("text",""+d)}function chkTime(a,b,c,d){var e,f=c.toString().length,g=$(a+b);g.value=g.value.replace(/[^\d]/g,"");var h=void 0===d?-1:d.code;if(37==h||39==h||9==h){if(g.blur(),37==h&&(e=b-1),39==h&&(e=b+1),9==h){if($(a+(b-1))){var i=$(a+(b-1)).value-0;10>i&&($(a+(b-1)).value="0"+i),0!=b&&$(a+b).select()}else $(a+b).select();return}if(e>2||0>e)return void g.select();var i=g.value-0;return 10>i&&(g.value="0"+i),void $(a+e).select()}if(g.value.length>=f)if(parseInt(g.value)>c){if(g.value=c,e=b+1,e>2||0>e)return;window.setTimeout(function(){$(a+e).select()},100)}else if(parseInt(g.value)<0)g.value="00";else{g.blur(),e=b+1;var i=g.value-0;if(g.value=10>i?"0"+i:""+i,e>2||0>e)return;window.setTimeout(function(){$(a+e).select()},100)}}function chkTimeEx(a,b,c,d){var e,f=$(a+b);f.value=f.value.replace(/[^\d]/g,"");var g=void 0===d?-1:d.code;if(37==g||39==g||9==g){if(f.blur(),37==g&&(e=b-1),39==g&&(e=b+1),9==g){if($(a+(b-1))){var h=$(a+(b-1)).value-0;10>h&&($(a+(b-1)).value="0"+h),0!=b&&$(a+b).select()}else $(a+b).select();return}if(e>3||0>e)return;var h=f.value-0;return 10>h&&(f.value="0"+h),void $(a+e).select()}if(f.value.length>=2)if(parseInt(f.value)>c){if(f.value=c,e=b+1,e>3||0>e)return;$(a+e).select()}else if(parseInt(f.value)<0)f.value="00";else{if(f.blur(),e=b+1,1>b)return void $(a+e).select();var i=b-1;if(24==$(a+i).value&&(f.value="00"),e>3||0>e)return;var h=f.value-0;10>h&&(f.value="0"+h),$(a+e).select()}}function chkLast(a){var b=a.value-0;10>b&&(a.value="0"+b)}function getMonthDay(a){var b=$(a+0).value-0,c=$(a+1).value-0,d=function(a){return a%4!=0||a%100==0&&a%400!=0?!1:!0};return 4==c||6==c||9==c||11==c?30:2==c&&d(b)?29:2!=c||d(b)?31:28}function getMonthDayEx(a,b){var c=function(a){return a%4!=0||a%100==0&&a%400!=0?!1:!0};return 4==b||6==b||9==b||11==b?30:2==b&&c(a)?29:2!=b||c(a)?31:28}function checkDay(a){$(a+0).value-0<2e3?$(a+0).value=2e3:$(a+0).value-0>2037&&($(a+0).value=2037),$(a+1).value-0<=0&&($(a+1).value="1"),$(a+1).value-0<10?$(a+1).value="0"+($(a+1).value-0):$(a+1).value-0>12&&($(a+1).value=12);var b=$(a+2).value-0,c=getMonthDay(a);if(0>=b)$(a+2).value="01";else if(10>b)$(a+2).value="0"+b;else{if(!(b>c))return;$(a+2).value=c}}function getSuggestBRIndex(a,b,c){void 0==c&&(c=!0);var d=[32,48,64,80,96,128,160,192,224,256,320,384,448,512,640,768,896,1024,1280,1536,1792,2048,4096,6144,8192,10240,12288,14336,16384,18432,20480,22528,24576,0],e=(a+b)/2,f=0;for(f=0;f<d.length;f++)if(d[f]>=e||c&&4096==d[f]||0==d[f+1])return d[f]>b?d[f-1]?d[f-1]:b:d[f];return 4096}function attachImputNoChinese(a,b){{var c=$(a);$(a).value}c.removeEvents("keyup"),c.removeEvents("blur"),c.addEvents({keyup:function(){0==checkedImportLimtEx(a,0,1)&&($(a).value=""),textFormat(a,b)},blur:function(){0==checkedImportLimtEx(a,0,1)&&($(a).value=""),textFormat(a,b)}})}function attathImputNumStr(a,b){var c=$(a);c.removeEvents("keyup"),c.removeEvents("keydown"),c.removeEvents("blur"),c.addEvents({keyup:function(){textFormat(a,b)},keydown:function(){isMaxlen(this)},blur:function(){isMaxlen(this)}})}function textFormat(a,b){var c=$(a).value,d=c.lens();if(d>b){for(var e=0,f="",g=0;g<c.length&&(f=c.slice(0,g+1),!(f.lens()>b));g++)e+=1;$(a).value=f.slice(0,e)}}function isMaxlen(a){for(var b=a.getAttribute?parseInt(a.getAttribute("maxlength")):"",c=a.value,d=0,e=0;e<c.length;e++)c.charCodeAt(e)>255&&d++;var f=c.length-d,g=f+3*d;a.getAttribute&&g>b&&(a.value=a.value.substring(0,(b/3).floor()))}function chkMaxlen(a){for(var b=a.getAttribute?parseInt(a.getAttribute("maxlength")):"",c=clipboardData.getData("text"),d=0,e=0;e<c.length;e++)c.charCodeAt(e)>255&&d++;var f=c.length-d,g=f+3*d,h=c.substring(0,(b/3).floor());a.getAttribute&&g>b?clipboardData.setData("text",h):clipboardData.setData("text",c)}function reps(a){var b=/"/g,c=/'/g,d=/</g,e=/>/g,f=/&/g,g=/ /g,h=a.replace(f,"&amp;");return h=h.replace(b,"&quot;"),h=h.replace(c,"&acute;"),h=h.replace(d,"&lt;"),h=h.replace(e,"&gt;"),h=h.replace(g,"&nbsp;")}function getChannelPicUrl(a,b){void 0==b&&(b=!0);var c=0,d=rpcCore.sessionID;return d&&(c=d),url=b?"/cgi-bin/Snapshot.cgi?channel="+a+"&sessionId="+c+"&"+(new Date).getTime():"/cgi-bin/Snapshot.cgi?channel="+a+"&sessionId="+c,url}function getJsonFile(a,b){{var c="";new Request({async:!1,url:"/debug/"+a+".json",onSuccess:function(a){var d=a.slice(a.indexOf(":")+1,a.length);c='{ "id" : 34, "params" : { "table" : '+d+' }, "result" : true, "session" : 46896896 }',b(c)},onFailure:function(){alert("failure")},onException:function(){alert("exception")}}).get()}return c}function disableButton(a,b,c){var d=$(a);c?(d.removeEvents("click"),d.addClass("ui-button-disabled")):(d.addEvent("click",b),d.removeClass("ui-button-disabled"))}function getFailureDetail(a,b){var c=ConfigManager.instance(),d=0;c.getFailureDetail(a,b,function(a,c){if(c.result&&c.params&&c.params.detail)switch(c.params.detail){case"CapsNotSupport":d++,alert(tl("com_str.comchannel")+" "+(b+1)+" "+tl("com_msg.confignotsupported"))}d||alert(tl("com_str.comchannel")+" "+(b+1)+" "+tl("com_msg.getIPCcfgfailed"))})}function limitMaxCharLength(a,b,c,d,e){void 0===d&&(d=!1),void 0===e&&(e=3);for(var f=getCaretPosition(a),g=a.value,h=0,i=-1,j=!0,k=0;k<g.length;k++)g.charCodeAt(k)>255?(h++,h*(e-1)+k>=c&&j&&(j=!1)):h*(e-1)+k==c&&j&&(j=!1);var l=g.length-h,m=l+h*e;if(m>c){if(i=0,!j){for(var n=g.slice(f),o=0,k=0;k<n.length;k++)n.charCodeAt(k)>255&&o++;var p=n.length+(e-1)*o,q=c-p;i=o,o=0;for(var k=0;f>k;k++)if(g.charCodeAt(k)>255&&o++,k+1+(e-1)*o>=q){k+1+(e-1)*o>q?(a.value=a.value.substring(0,k)+n,setCaretPosition(a,k),o--):(a.value=a.value.substring(0,k+1)+n,setCaretPosition(a,k+1));break}i+=o}d||remarkDisplay(b,tl("com_msg.maxStrLen"),3e3,1)}else m!==c||d||(i=0,remarkDisplay(b,tl("com_msg.maxStrLen"),3e3,1));i=-1===i?h:i,a.setProperty("maxlength",0>c-i*(e-1)?c:c-i*(e-1))}function limitMaxCharLengthEx(a,b,c,d,e){void 0==e&&(e=3);for(var f=d,g=a.value,h=0,i=-1,j=!0,k=0;k<g.length;k++)g.charCodeAt(k)>255?(h++,h*(e-1)+k>=c&&j&&(j=!1)):h*(e-1)+k==c&&j&&(j=!1);var l=g.length-h,m=l+h*e;if(m>c){if(i=0,!j){for(var n=g.slice(f),o=0,k=0;k<n.length;k++)n.charCodeAt(k)>255&&o++;var p=n.length+(e-1)*o,q=c-p;i=o,o=0;for(var k=0;f>k;k++)if(g.charCodeAt(k)>255&&o++,k+1+(e-1)*o>=q){k+1+(e-1)*o>=q&&(a.value=a.value.substring(0,k+1)+n,o--);break}i+=o}remarkDisplay(b,tl("com_msg.maxStrLen"),3e3,1)}else m===c&&(i=0,remarkDisplay(b,tl("com_msg.maxStrLen"),3e3,1));i=-1===i?h:i,a.setProperty("maxlength",c-i*(e-1))}function attachMaxCharLength(a,b,c,d,e){var f=!1,g=$(a);void 0!==e&&(f=e),g.addEvents({keyup:function(){void 0==d?limitMaxCharLength(g,b,c):limitMaxCharLength(g,b,c,f,d)},blur:function(){g_curPosition=document.selection?g_curPosition:getCaretPosition(g)},keydown:function(){g_curPosition=getCaretPosition(g)}})}function showChannelIcons(a,b,c,d){void 0==c&&(c=CHANNEL_NUMBER);var e=[];if(e.push(c>32?'<div class="scr_left"><a class="scr_lefticon" href="javascript:;" onclick="turnPage(-1, \''+a+'\')"></a></div><div class="ui-channel" style="height:54px;">':'<div class="ui-channel">'),"array"==$type(d))for(var f=0;f<d.length;f++)e.push('<a href="javascript:;" class="ui-channel-item" id="'+(b+d[f])+'" onclick="clickChannelButton(this)">'+(d[f]+1)+"</a>");else for(var f=0;c>f;f++)e.push('<a href="javascript:;" class="ui-channel-item" id="'+(b+f)+'" onclick="clickChannelButton(this)">'+(f+1)+"</a>");e.push("</div>"),c>32&&e.push('<div class="scr_right"><a class="scr_rigicon" href="javascript:;" onclick="turnPage(1, \''+a+"')\"></a></div>"),$(a).innerHTML=e.join("")}function turnPage(a,b){var c=$(b).getElement(".ui-channel");if(c){var d=parseInt(c.getStyle("margin-top")),e=d-54*a;(0>a&&0>d||a>0&&0==d)&&(c.setStyle("margin-top",e),c.setStyle("height",54-e))}}function clickChannelButton(a){var a=$(a.id);a.hasClass("ui-channel-item-current")?a.removeClass("ui-channel-item-current"):a.addClass("ui-channel-item-current")}function showLoadingCfg(a,b,c,d,e){void 0!=d&&$("lab_loadingCfg").setProperty("text",d),void 0===c&&(c=1e4),void 0!=b&&($("lab_loadingCfg").style.top=b+"%"),void 0==e&&(e=!1),a?($("loadingCfg").style.display="block",$("lab_loadingCfg").style.display="block",$("loadingCfg").style.top="0px",timeoutDIV=setTimeout(function(){e||($("loadingCfg").style.top="-10000px")},c)):($("loadingCfg").style.top="-10000px",clearTimeout(timeoutDIV))}function handleBlank(a){for(var b=$(a).value,c=0;0==c&&(c=b.indexOf(" "),-1!=c);)0==c&&(b=b.slice(c+1));for(c=b.length;b.length==c&&(c=b.lastIndexOf(" "),-1!=c);)b.length-1==c&&(b=b.slice(0,c));$(a).value=b}function attachCheckPsw(a){var b=$(a);b.removeEvents("keyup"),b.removeEvents("blur"),b.addEvents({keyup:function(){b.value=b.value.replace(/[:]/g,"")},blur:function(){b.value=b.value.replace(/[:]/g,"")}})}function attachDateLimit(a,b,c,d){var e=$(a);void 0!=d&&e.setProperty("maxlength",d),e.removeEvents("keyup"),e.removeEvents("blur"),e.removeEvents("keydown"),e.addEvents({keyup:function(){limit(this,c)},blur:function(){limit(this,c),limitMinEx(this,b)},keydown:function(){limit(this,c)}})}function compareTime(a,b){var c=new Date(a.replace(/-/g,"/")),d=new Date(b.replace(/-/g,"/"));return c>d?1:d>c?-1:0}function attachMutiTypeInputLimit(a,b){var c,d=$(a);switch(b){case 0:c=/[^\s\w-!?@=+#$%&*|/:,.]/g;break;case 1:c=/[^\s\w-!?@=+#$%&*|/:,.\u4E00-\u9FA5]/g;break;case 2:c=/[^\s\w-!?@#$%&*|/,.]/g;break;case 3:c=/[^\s\w-+=,.\u4E00-\u9FA5]/g;break;case 4:c=/[^\w-]/g;break;case 5:c=/[^\s\w-!@\/#$&,.\u4E00-\u9FA5]/g;break;case 6:c=/[^\s\w-!@#$%,.\u4E00-\u9FA5]/g;break;case 7:c=/[^\s\w-!@#$%&+,.\u4E00-\u9FA5]/g;break;case 8:c=/[^\s\w-!?@#$%*+=|/:,.\u4E00-\u9FA5]/g;break;case 9:c=/[^\s\w-!?@#$%*/:,.]/g;break;case 10:c=/[&'"]/g;break;case 11:c=/[^a-zA-Z\d]/g;break;case 12:c=/[^\w]/g;break;case 13:c=/[^\w]/g;break;case 14:c=/[^\w-]/g;break;case 15:c=/[^\s\w-!?@#=$%&*+|/:,.\u4E00-\u9FA5]/g;break;case 16:c=/[^\s\w-!+=?@#$%*|,.]/g;break;case 17:c=/[^\s\w-!?@#$%=+*_,.]/g;break;case 18:c=/[^\s\w-_.]/g;break;case 19:c=/[^\s\w-_/]/g;break;case 20:c=/[^\w-_.@:]/g;break;case 21:c=/[^\w-_.:]/g}d.addEvents({keyup:function(){var a=d.value.search(c);-1!=a&&(d.value=d.value.replace(c,""),setCaretPosition(d,a))},blur:function(){d.value=d.value.replace(c,"")}})}function setCaretPosition(a,b){if(a.setSelectionRange)setTimeout(function(){a.setSelectionRange(b,b),a.focus()},0);else if(a.creatTextRange){var c=a.creatTextRange();c.collapse(!0),c.moveStart("character",b),c.moveEnd("character",b),c.select()}}function getCaretPosition(a){var b=-1;try{if(document.selection){var c=document.selection.createRange();c.moveStart("character",-a.value.length),b=c.text.length}else b=a.selectionStart}catch(d){b=0}return b}function preventBubble(a){isIE?event.cancelBubble=!0:a.stopPropagation()}function getElementsByNameEx(a,b){var c=document.getElementsByTagName(a),d=new Array;if(null!=c&&c.length>0)for(var e=0;e<c.length;e++)c[e].getAttribute("name")==b&&(d[d.length]=c[e]);return d}function getElementsByNameS(a,b){var c=document.getElementsByTagName(a),d=new Array;if(null!=c&&c.length>0)for(var e=0;e<c.length;e++)c[e].getAttribute("name").contains(b)&&(d[d.length]=c[e]);return d}function hideId(a,b){$(b).style.display=a?"":"none"}function attachTime12_24(a,b){$(a+"0")&&($(a+"0").removeEvents("keyup"),$(a+"0").removeEvents("focus"),$(a+"0").removeEvents("blur"),$(a+"0").addEvents({keyup:function(c){limit(this,b);var d=c.code;return 39==d&&null!=$(a+"1")?void $(a+"1").select():37==d&&null!=$(a+"2")?void $(a+"2").select():void(this.value.length>=2&&window.setTimeout(function(){$(a+"1").select()},100))},focus:function(){this.select()},blur:function(){limit_ts(this,b),""==$(a+"0").value&&($(a+"0").value="00"),12==b&&this.value-0==0&&(this.value=12)}}))}function changeFmt(a){var b;b="PM"==$(a+"3").value?"12"==$(a+"0").value?"12":$(a+"0").value-0+12:"12"==$(a+"0").value?"00":$(a+"0").value;var c=b+":"+$(a+"1").value+":"+$(a+"2").value;return c}function cAMPM(a){""!=a.value&&(a.value="AM"==a.value?"PM":"AM")}function chkOpenPage(a){return $(a).hasClass("set-item-current")?!0:!1}function checkIputFomartIP(a){return(a+256).toString(2).substring(1)}function validateMask(a,b,c,d){if(0==a)return!1;var e=checkIputFomartIP(a)+checkIputFomartIP(b)+checkIputFomartIP(c)+checkIputFomartIP(d);return-1!=e.indexOf("01")?!1:!0}function isEqualIPAddress(a,b,c,d){if(!(a&&b&&c&&d&&"0.0.0.0"!=a&&"0.0.0.0"!=b))return!1;var e=[],f=[];a=a.split("."),b=b.split("."),c=c.split("."),d=d.split(".");for(var g=0;g<a.length;g++)e.push(parseInt(a[g]&parseInt(c[g]))),f.push(parseInt(b[g]&parseInt(d[g])));return e.join(".")==f.join(".")?!0:void 0}function IsExistLocalUser(){var a=!1,b=function(b){if(JSON.decode(b).result&&(jsonAllUsers=JSON.decode(b).params.users,null!=jsonAllUsers))for(var c=0;c<jsonAllUsers.length;c++)if("GUI"==jsonAllUsers[c].ClientType&&"default"!=jsonAllUsers[c].Name){a=!0;break}},c=UserManager.instance();return c.getActiveUserInfoAll(b,!1),a}function getIpFromRtspUrl(a){var b="rtsp://",c=b.length;if(a.substring(0,c)!=b)return"";var d=a.substring(c),e=d.match(/((2[0-4]\d|25[0-5]|[01]?\d\d?)\.){3}(2[0-4]\d|25[0-5]|[01]?\d\d?)/);return e?e[0]:""}function capa2TB(a){var b=a;if(null==a&&(b=0),!b&&0!=b)return"-";for(var c=0;3>c;c++)b=Math.floor(b/1024*100)/100;return b>1024?Math.floor(b/1024*100)/100+"TB":b+"GB"}function capa2Str(a){for(var b=a,c=0;3>c;c++)b=Math.floor(b/1024*100)/100;return b+"GB"}function capa2StrEx(a){var b=a;return b=Math.floor(b/1024*100)/100,b+"GB"}function getOnlineDevChannel(){var a=[];return LogicDeviceManager.instance().getCameraState(-1,function(b,c){c.result&&c.params&&"array"===$type(c.params.states)&&c.params.states.each(function(b){"Connected"===b.connectionState&&a.include(b.channel)})},!1),a}function getFileName(a){var b=a.split("/");return b[b.length-1]}function isIPv4(a){return/(^(2[0-4]\d|25[0-5]|1\d{2}|[1-9]\d?|0)\.)((2[0-4]\d|25[0-5]|1\d{2}|[1-9]\d?|0)\.){2}(2[0-4]\d|25[0-5]|1\d{2}|[1-9]\d?|0)$/.test(a)?!0:!1}function getLocalHash(){new Request({url:"/local.png",async:!1,onSuccess:function(a){var b=a.split("\n");b.filter(function(a){if(""!=a.trim()&&a.test("=","i")){var b=a.split("=");localHash.include(b[0].trim(),b[1].trim())}})},onFailure:function(){},onException:function(){}}).get()}function isKeyEnable(a){var b=localHash.get(a)-0;return b?b:!1}function markChannelType(a,b,c){a.length=CHANNEL_NUMBER;var d=ConfigManager.instance(),e=function(b){var d=JSON.decode(b).result;if(d){var e=JSON.decode(b).params.table;void 0!=c&&(c.length=e.length,e.each(function(a,b){c[b]=a}));for(var f=0;f<CHANNEL_NUMBER;f++)void 0!=e[f].CaptureChip?f<CHANNEL_NUMBER-REMOTE_CHANNELS?1920==e[f].CaptureChip.Width?a[f]=2:960==e[f].CaptureChip.Width&&(a[f]=1):a[f]=0:a[f]=-1}};d.getConfig("VideoIn",e,b)}function chkIpmatch(a,b,c){var d=!0;return d=(a[0]&c[0])==(b[0]&c[0])&&(a[1]&c[1])==(b[1]&c[1])&&(a[2]&c[2])==(b[2]&c[2])&&(a[3]&c[3])==(b[3]&c[3])}function jsonAddPath(a){createPath(a,["EventHandler","RecordChannels"]),createPath(a,["EventHandler","RecordLatch"]),createPath(a,["EventHandler","SnapshotChannels"]),createPath(a,["EventHandler","SnapshotTimes"]),createPath(a,["EventHandler","AlarmOutChannels"]),createPath(a,["EventHandler","AlarmOutLatch"]),createPath(a,["EventHandler","MonitorTour",0,"Channels"]),createPath(a,["EventHandler","MonitorTour",0,"Split"])}function createPath(a,b){var c=$unlink(b)||[];if(0==c.length)return a;if(1==c.length)return a[c[0]]||(a[c[0]]={}),a[c[0]];a[c[0]]||(a[c[0]]={});var d=a[c[0]];return c.shift(),createPath(d,c)}function comparVersion(a,b){for(var c=a.split("."),d=b.split("."),e=Math.max(c.length,d.length),f=0;e>f;++f){var g=(c[f]||0)-(d[f]||0);if(g)return g}return 0}function setHDDGroupDefault(){var a=[],b=[],c=[],d=StorageDVR.instance(),e=function(c,e){if(e.result){e.params&&(a=e.params.list||[]);var f=function(a,c){c.result&&b.include(c.result)};a.each(function(a){d.instance(a,f,!1)})}};d.getDirectoryPaths(e,!1);for(var f=0;f<b.length;f++){var g=function(a,d){d.result&&(c[f]=d.params.info,c[f].pntindex=b[f])};d.getInfo(b[f],g,!1)}var h={};h.Mode=0,ConfigManager.instance().setConfig("HDDMode",h,void 0,!1),c.each(function(a,b){var e=a.Group;$chk(e)&&e.indexOf("ReadWrite")>=0&&0!=e.replace(/[^\d]/g,"")&&d.setGroup("ReadWrite0",c[b].pntindex,void 0,!1)})}function usernameEncrypt(a){var b,c=a,d=c.length,e=new Array(d);if(8>=d)for(var f=0;d>f;f++)b=c.charCodeAt(f),e[f]=String.fromCharCode(b+3);else for(var f=0;d>f;f++)0==f?(b=c.charCodeAt(f),e[f]=String.fromCharCode(b+3)):(b=c.charCodeAt(f),e[f]=String.fromCharCode(b));return c=e.join("")}function encryptUserBydemes(a){for(var b,c=a.length,d=new Array(c),e=0;c>e;e++)b=a.charCodeAt(e),d[e]=String.fromCharCode(b+1);return a=d.join("")}function changeOcxMode(a){"Camera"==g_mode&&g_mode!=a&&g_ocx&&g_ocx.StopPreview(),g_mode=a;var b={};switch(a){case"FacePlayBack":var c=caculateFrameWH();b.top=65,b.left=$("f_faceplay").getWidth()-408-2,b.width=408,b.height=325;break;case"Playback":var c=caculateFrameWH();b.top=hasPlugin?69:0,b.left=2,b.width=c[0]-215,b.height=c[1]-198;break;case"Preview":var c=caculateFrameWH();b.top=hasPlugin?68:0,b.left=g_frames.preview.g_ptzEnable||(0!=g_frames.preview.g_almChNO||0!=g_frames.preview.REMOTE_CHANNELS)&&0!=g_frames.preview.REMOTE_CHANNELS?156:226,b.width=c[0]-317,b.height=c[1]-36-49;break;case"Camera":var d=g_frames?g_frames.setup:window;b.top=hasPlugin?$("f_setup").style.top.replaceToNum()+d.$("ca_set").offsetTop+14:40,b.left=d.$("cmaincont").offsetLeft+15,b.width=401,b.height=321;break;case"IvsVedio":var d=g_frames?g_frames.setup:window;b.top=$("f_setup").style.top.replaceToNum()+d.$("ipcIntellentNew_tab_public").offsetTop+10,b.left=d.$("cmaincont").offsetLeft+15,b.width=450,b.height=337;break;case"Hidden":b.top=-1e4}changeOcxStyle(b)}function changeOcxStyle(a){$("f_ocx")&&$("f_ocx").setStyles(a)}function getPwdLevel(a){var b=0;return b+=a.length<=4?5:a.length>=8?25:10,b+=a.match(/[a-z]/i)?a.match(/[a-z]/)&&a.match(/[A-Z]/)?20:10:0,b+=a.match(/[0-9]/)?a.match(/[0-9]/g).length>=3?20:10:0,b+=a.match(/[^A-Za-z0-9]/)?a.match(/[^A-Za-z0-9]/g).length>1?25:10:0,b+=a.match(/[0-9]/)&&a.match(/[a-z]/i)?a.match(/[^A-Za-z0-9]/)?a.match(/[a-z]/)&&a.match(/[A-Z]/)?5:3:2:0,50>b?"low":b>=70?"high":"middle"}function testEmailFormat(a){if(""==a)return!0;var b=a.split("@")[1],c=a.length;if($chk(b)&&"@"!=a.charAt(0)&&"@"!=a.charAt(c-1)){for(var d=c-b.length-1,e=c-d-1,f=0;d>f;f++)if(!(/[a-zA-Z0-9_\-]/.test(a.charAt(f))||"."==a.charAt(f)&&0!=f&&f!=d-1))return!1;for(var g=!1,f=0;e>f;f++)if(!/[a-zA-Z0-9_\-]/.test(a.charAt(d+1+f))){if(0==f||f==e-1)return!1;if("."!=a.charAt(d+1+f)||"."==a.charAt(d+1+f+1))return!1;g=!0}return g?!0:!1}return!1}function getValueLen(a){return a=String(a),a.lengthB()}var g_curPosition=-1,g_addDevCh=[],Page={},Cache={},isIE=-1!=navigator.appName.indexOf("Microsoft"),jsonLang,g_langHashTr=new Hash({StringsEn:"English",StringsCn:"SimpChinese"});getlang();var localPngHash=new Hash;getLocalPngHash();var getConfigR=function(){var a=new Hash,b=function(b,c){var d=a.get(b);if(null==d){var e=function(d){if(JSON.decode(d).result){var e=JSON.decode(d).params.table;a.include(b,e),c(e)}else c(!1)},f=ConfigManager.instance();f.getConfig(b,e,!1)}else c(d);return d};return b}(),isIPC=!1,spe_rebootDialog,hasAlertReboot=!1,DialogApplyTo=new Class({initialize:function(a,b,c,d,e){void 0==d&&(d=[]),void 0==e&&(e=!1);var f="";"ApplyToLocalAlarmCh"!=a&&(f=tl("com_str.comchannel"));var g=[];if(g.push('<div class="ui-dialog-title"><h1>'+tl("com_str.applyto")+'</h1><a class="ui-dialog-icon"></a></div><div class="ui-dialog-container"><div class="ui-dialog-content" style="max-height:330px;overflow-y:auto;overflow-x:hidden;">'),g.push('<div class="ui-form-item fn-clear"><div class="ui-checkbox fn-padl20"><input type="checkbox" id="'+a+'_all"/></div><label class="ui-label-sub fn-width80" for="'+a+'_all">'+tl("com_str.comall")+"</label></div>"),0!=d.length)for(var h=0;h<d.length;h++)h%2==0&&g.push('<div class="ui-form-item fn-clear">'),g.push('<div class="ui-checkbox fn-padl20"><input type="checkbox" id="'+a+"_"+d[h]+'" /></div><label class="ui-label-sub fn-width80" for="'+a+"_"+d[h]+'">'+f+" "+d[h]+"</label>"),(h%2==1||h==d.length-1)&&g.push("</div>");else for(var i=0;c/2>i;i++)g.push('<div class="ui-form-item fn-clear"><div class="ui-checkbox fn-padl20"><input type="checkbox" id="'+a+"_"+(2*i+1)+'" /></div><label class="ui-label-sub fn-width80" for="'+a+"_"+(2*i+1)+'">'+f+" "+(2*i+1)+"</label>"),c>=2*i+2&&g.push('<div class="ui-checkbox fn-padl20"><input type="checkbox" id="'+a+"_"+(2*i+2)+'"/></div><label class="ui-label-sub fn-width80" for="'+a+"_"+(2*i+2)+'">'+f+" "+(2*i+2)+"</label>"),g.push("</div>");1==e&&g.push('<div class="ui-form-item fn-clear"><label class="ui-label-sub">'+tl("conf_copy.explain")+"</label></div>"),g.push('</div><div class="ui-button-box"><a class="ui-button" id="'+a+'_confirm" href="javascript:;">'+tl("com_button.comok")+'</a><a class="ui-button" href="javascript:;" id="'+a+'_close">'+tl("com_button.comcanncel")+"</a></div>"),g.push("</div>");var j=document.createElement("div");j.className="ui-dialog fn-width320",j.id=a,j.innerHTML=g.join(""),$("cmaincont").appendChild(j);var k=new Dialog(a,b,a+"_confirm",a+"_close");k.setPosition(330,140),this.diag=k,this.obj=$(a);var l=$(a).getElement("input");l.addEvent("click",function(){$(a).getElements("input[type=checkbox]").each(function(a,b){0==b||a.disabled||(a.checked=l.checked)})});for(var m=$(a).getElements("input[type=checkbox]"),i=0;i<m.length;i++)m[i].addEvent("click",function(){!this.checked&&l.checked&&(l.checked=!1)})},show:function(a){void 0==a&&(a=0),this.obj.getElements("input[type=checkbox]").each(function(b,c){c==a+1?(b.checked=!0,b.disabled=!0):(b.checked=!1,b.disabled=!1)}),this.diag.show()},close:function(){this.diag.close()},getMask:function(){var a=0;return this.obj.getElements("input[type=checkbox]").each(function(b,c){0!=c&&b.checked&&(a+=Math.pow(2,c-1))}),this.close(),a},getMaskStr:function(){var a="";return this.obj.getElements("input[type=checkbox]").each(function(b,c){0!=c&&(a=b.checked?"1"+a:"0"+a)}),this.close(),a},setMask:function(){}}),DialogApplyToEx=new Class({initialize:function(a,b,c){if(void 0!=c&&c!=CHANNEL_NUMBER){var d=[];d.push('<div class="ui-dialog-title"><h1>'+tl("com_str.applyto")+'</h1><a class="ui-dialog-icon"></a></div><div class="ui-dialog-container"><div class="ui-dialog-content" style="max-height:330px;overflow-y:auto;overflow-x:hidden;">'),d.push('<div class="ui-form-item fn-clear"><div class="ui-checkbox fn-padl20"><input type="checkbox" id="'+a+'_all"/></div><label class="ui-label-sub" for="'+a+'_all">'+tl("com_str.comall")+"</label></div>");for(var e=0;c/2>e;e++)d.push('<div class="ui-form-item fn-clear"><div class="ui-checkbox fn-padl20"><input type="checkbox" id="'+a+"_"+(2*e+1)+'" /></div><label class="ui-label-sub fn-width80" for="'+a+"_"+(2*e+1)+'">'+tl("com_str.comchannel")+" "+(2*e+1)+"</label>"),c>=2*e+2&&d.push('<div class="ui-checkbox fn-padl20"><input type="checkbox" id="'+a+"_"+(2*e+2)+'"/></div><label class="ui-label-sub" for="'+a+"_"+(2*e+2)+'">'+tl("com_str.comchannel")+" "+(2*e+2)+"</label>"),d.push("</div>");d.push('</div><div class="ui-button-box"><a class="ui-button" id="'+a+'_confirm" href="javascript:;">'+tl("com_button.comok")+'</a><a class="ui-button" href="javascript:;" id="'+a+'_close">'+tl("com_button.comcanncel")+"</a></div>"),d.push("</div>");var f=document.createElement("div");f.className="ui-dialog fn-width300",f.id=a,f.innerHTML=d.join(""),$("cmaincont").appendChild(f);var g=$(a).getElement("input");g.addEvent("click",function(){$(a).getElements("input[type=checkbox]").each(function(a,b){0==b||a.disabled||(a.checked=g.checked)})});for(var h=$(a).getElements("input[type=checkbox]"),e=0;e<h.length;e++)h[e].addEvent("click",function(){!this.checked&&g.checked&&(g.checked=!1)})}else a="apply_div",$(a+"_confirm").removeEvents("click"),$(a+"_close").removeEvents("click");var i=new Dialog(a,b,a+"_confirm",a+"_close");i.setPosition(330,140),this.diag=i,this.obj=$(a)},show:function(a){void 0==a&&(a=0),this.obj.getElements("input[type=checkbox]").each(function(b,c){c==a+1?(b.checked=!0,b.disabled=!0):(b.checked=!1,b.disabled=!1)}),this.diag.show()},close:function(){this.diag.close()},getMask:function(){var a=0;return this.obj.getElements("input[type=checkbox]").each(function(b,c){0!=c&&b.checked&&(a+=Math.pow(2,c-1))}),this.close(),a},getMaskStr:function(){var a="";return this.obj.getElements("input[type=checkbox]").each(function(b,c){0!=c&&(a=b.checked?"1"+a:"0"+a)}),this.close(),a},setMask:function(){}});Element.implement({selectedIndexEx:function(){var a;return a=0===REMOTE_CHANNELS?this.selectedIndex:"ALL"==this.getSelected().getProperty("text")?this.getProperty("channelnum")-0:""==this.getSelected().getProperty("text")?this.getParent().getElement("p").getProperty("text")-1:this.getSelected().getProperty("text")-1},addEventAll:function(a,b,c){c=c||!1,this.addEventListener?(Browser.firefox&&(a="mousewheel"==a?"DOMMouseScroll":a),this.addEventListener(a,b,c)):this.attachEvent?this.attachEvent("on"+a,b):this["on"+a]=b},fadeIn:function(){Browser.ie7||Browser.ie8||Browser.ie9?this.setOpacity(1):this.fade("in")},fadeOut:function(){Browser.ie7||Browser.ie8||Browser.ie9?this.setOpacity(0):this.fade("out")},getValueIndex:function(a){if(this.options)for(var b=0;b<this.options.length;b++)if(this.options[b].value==a)return b;return-1},removeValue:function(a){var b=this.getValueIndex(a);return b>=0&&this.remove(b),this},translation:function(a){var b=this.getElements("[t]"),c=function(b){if("function"==$type(a))return a(b);if(0==$type(a)){if("function"==typeof tl){var c=b.split(/[\[\]]/),d=tl(c[0]),e=c[1]-0;if(!isNaN(e)){var f=d.split("|");d=f[e]}return d}return b}return a[b]};return b.push(this),b.each(function(a){var b,d=a.getProperty("t");
d&&(b=d.split(";"),b.each(function(b){var d=b.split("::");1===d.length&&(d[1]=d[0],d[0]="text");var e=d[1].split("+"),f="";e.each(function(a){f+=c(a)}),a.setProperty(d[0],f)}))}),this},setDisabled:function(a){if(a){var b=this.retrieve("events");for(var c in b)if(null!=b[c]){this.store("backevents",$unlink(b));break}this.removeEvents().addClass("ui-button-disabled")}else{var d=this.retrieve("backevents");for(var c in d)if(d[c]&&d[c].keys)for(var e=0,f=d[c].keys.length;f>e;e++)this.addEvent(c,d[c].keys[e]);this.removeClass("ui-button-disabled")}return this},display:function(a){return arguments.length?(a="string"==typeof a?a:a?"":"none",this.setStyle("display",a)):this.style.display},setSelectVal:function(a){return this.value=a,-1==this.selectedIndex&&(this.selectedIndex=0),this},addOptions:function(a,b){var c=this.options;b=b||[];for(var d=0,e=a.length;e>d;d++)c.add(new Option(a[d],b[d]||d));return this},testBackgroundImage:function(a){var b=this;return new Request({url:a,async:!1,onSuccess:function(){b.setStyle("background","url("+a+") no-repeat scroll center bottom")}}).get(),this}}),Elements.implement({getChecked:function(){var a=[];return this.each(function(b){b.checked&&a.push(b)}),a.length>0?new Elements(a):a},getEnable:function(){var a=[];return this.each(function(b){1!=b.disabled&&a.push(b)}),a.length>0?new Elements(a):a}}),SliderEx=new Class({Extends:Slider,initialize:function(a,b,c){this.parent(a,b,c);var d=typeof c.valueSpan;"string"==d?this.options.valSpan=$(c.valueSpan):"object"==d&&(this.options.valSpan=c.valueSpan),this._changeSpan()},setValue:function(a){return this.range>0^a<this.min||(a=this.min),this.range>0^a>this.max||(a=this.max),this.step=Math.round(a),this.knob.setStyle("left",this.toPosition(a)),this.element.setProperty("title",a),this.options.valSpan&&this.options.valSpan.setProperty("text",a),this.previousChange=this.previousEnd=a,this},_changeSpan:function(){var a=this;this.addEvent("change",function(b){a.element.setProperty("title",b),a.options.valSpan&&a.options.valSpan.setProperty("text",b)})},setRange:function(a){this.options.range=a,this.min=$chk(this.options.range[0])?this.options.range[0]:0,this.max=$chk(this.options.range[1])?this.options.range[1]:this.options.steps,this.range=this.max-this.min,this.stepSize=Math.abs(this.range)/this.steps,this.stepWidth=this.stepSize*this.full/Math.abs(this.range)}});var parsrTime=function(a){var b;if(a){var c=a.trim().split(" "),d=c[1].split("-"),a=d[0].split(":"),e=d[1].split(":");b=[c[0],a[0],a[1],e[0],e[1]]}else b=[0,0,0,24,0];return b},parsrTimeEx=function(a){var b;if(a){var c=a.trim().split(" "),d=c[1].split("-"),a=d[0].split(":"),e=d[1].split(":");b=[c[0]-0,a[0]-0,a[1]-0,a[2]-0,e[0]-0,e[1]-0,e[2]-0]}else b=[0,0,0,0,24,0,0];return b},getSnapFPS=function(a){return a>=2?0:a>=-1&&1>=a?1:-1>a&&a>=-7?0-a:7},getBitEx=function(a,b){var c=a-0,d=c.toString(2),e=d.length,f=d.charAt(e-b-1);return"1"==f?1:0},getBitStr=function(a,b){var c=a.length,d=a.charAt(c-b-1);return"1"==d?1:0},setBit=function(a,b,c){var d=a-0;return 1==c?d|=1<<b:d&=~(1<<b),d},limit=function(a,b){var c=$(a).value;$(a).value=c.replace(/[^\d]/g,"");var d=$(a).value-0;return d>b?($(a).value=b,b):d},limit_ts=function(a,b){var c=$(a).value;$(a).value=c.replace(/[^\d]/g,"");var d=$(a).value-0;return d>b?($(a).value=b,b):10>d?($(a).value="0"+d,"0"+d):d},limitEx=function(a,b,c){var d=a.value;"0"==d.charAt(0)&&(d=d.slice(1)),a.value=d.replace(/[^\d]/g,""),b>d-0&&10>c?a.value=b:d-0>c&&(a.value=c)},limitEx0=function(a,b,c){var d=a.value;a.value=d.replace(/[^\d]/g,""),b>d-0&&10>c?a.value=b:d-0>c&&(a.value=c)},limitMin=function(a,b){var c=a.value;b>=c-0&&(a.value=b)},checkTime0=function(a){var b;return b=10>a-0?"0"+(a-0):""+a},chkIsAll=function(){for(var a=[],b=0;b<CHANNEL_NUMBER;b++)a.extend(0==$("ach"+b).checked?["false"]:["true"]);$("ach").checked=a.contains("false")?!1:!0};Array.implement({indexXY:function(a){for(var b=[0,0],c=a+1,d=0;d<this.length;d++){var e=this[d].length;{if(!(c-e>0)){b[0]=d,b[1]=c-1;break}c-=e}}return b},configFilter:function(){var a=[],b=[];for(i=0;i<this.length;i++)null!=this[i]&&(a.push(i),b.push(this[i]));return[a,b]},toJsonKey:function(a){for(var b={},c=this.length,d=0;c>d;d++)b[this[d][a]]=b[this[d][a]]||[],b[this[d][a]].push(this[d]);return b}}),String.prototype.lens=function(){return this.replace(/[^\x00-\xff]/g,"xxx").length},String.prototype.testDahua=function(){return this.test(/dahua/i)};var DialogConfirm=new Class({initialize:function(a,b,c){this.html='<div class="ui-dialog-title"><h1 class="titleH">title</h1><a class="ui-dialog-icon" href="javascript:;"></a></div><div class="ui-dialog-container"><div class="ui-dialog-content" style="padding:10px 17px;"><div class="ui-autobox"><div class="ui-autobox-content"><i class="ui-dialog-surebox-icon"></i><span class="ui-dialog-surebox-text">'+tl(c)+'</span></div></div></div><div class="fn-clear"></div><div class="ui-button-box fn-clear"><a id="'+a+'_sureButton" href="javascript:;" style="display:inline-block;" class="ui-button">'+tl("com_button.yes")+'</a><a id="'+a+'_cancelButton" href="javascript:;" style="display:inline-block;" class="ui-button">'+tl("com_button.no")+"</a></div></div>";var d=document.createElement("div");d.className="ui-dialog",d.id=a,d.style.top="-10000px",d.innerHTML=this.html,this.newDIV=d,$("cmaincont").appendChild(d),this.closeButton=$(a+"_cancelButton");var e=new Dialog(a,b,a+"_sureButton",a+"_cancelButton",tl("conf_gen.reboot"));this.closeButton.addEvent("click",function(){$("cmaincont").removeChild(d)}),this.closeIcon=e.closeIcon,this.closeIcon.addEvent("click",function(){$("cmaincont").removeChild(d)}),this.diag=e,this.obj=$(a)},show:function(){$("cmaincont").hasChild(this.newDIV)||$("cmaincont").appendChild(this.newDIV),this.diag.setPosition(300,200),this.diag.show()},close:function(){this.diag.close(),$("cmaincont").removeChild(this.newDIV)}}),timeoutDIV=0,limitMinEx=function(a,b){var c=a.value;b>=c-0&&(a.value=b),a.value-0<10&&(a.value="0"+(a.value-0))};Date.compareTime=function(a,b){return a=a.trim(),b=b.trim(),new Date("1980/01/01 "+a)-new Date("1980/01/01 "+b)},String.prototype.sprintf=function(){var a=0,b=arguments;return this.replace(/%s/g,function(){return a<b.length?b[a++]:""})},String.prototype.replaceToNum=function(a){a=a||1;var b=/[^\d]/g;switch(a){case 2:b=/^.*[^\d*]/g}var c=this.replace(b,"");return""===c?-1:parseInt(c)},Number.prototype.formatStrLen=function(a){var b=[],c=this.toString();return b.length=a>c.length?a-c.length+1:0,b.join("0")+c},Number.prototype.precise=function(a){var b=Math.pow(10,a);return Math.round(this*b)/b},Date.prototype.toStringFormat=function(formater){var z={y:this.getFullYear(),M:this.getMonth()+1,d:this.getDate(),h:this.getHours(),m:this.getMinutes(),s:this.getSeconds()};return formater=formater||"yyyy-MM-dd hh:mm:ss",formater=formater.replace(/(M+|d+|h+|m+|s+)/g,function(v){return((v.length>1?"0":"")+eval(z[v.slice(-1)])).slice(-2)}),formater.replace(/(y+)/g,function(a){return z.y.toString().slice(-a.length)})};var FineSlider=new Class({initialize:function(a,b,c,d,e,f){this.element=$(a);var g=a.split("_");g.pop()&&g.push("label")&&(g=g.join("_"));var h=$(d)||$(g),i=a.split("_");i.pop()&&i.push("add")&&(i=i.join("_"));var j=a.split("_");j.pop()&&j.push("reduce")&&(j=j.join("_")),this.addElement=$(e)||$(i),this.reduceElement=$(f)||$(j),c.steps||"array"!=$type(c.range)||(c.steps=c.range[1]-c.range[0]),c.wheel||(c.wheel=!0),c.onChange||(c.onChange=function(a){this.element.setProperty("title",a),h.setProperty("text",a)}),this.slider=new Slider(a,b,c),this.steps=-1,this.addElement&&this.addElement.addEvent("click",this.add.bind(this)),this.reduceElement&&this.reduceElement.addEvent("click",this.reduce.bind(this))},add:function(){this.steps=this.element.getProperty("title")-0,this.steps>=this.slider.min&&this.steps<this.slider.max&&(this.steps+=1,this.slider.set(this.steps))},reduce:function(){this.steps=this.element.getProperty("title")-0,this.steps>this.slider.min&&this.steps<=this.slider.max&&(this.steps-=1,this.slider.set(this.steps))},set:function(a){return a=a.limit(this.slider.min,this.slider.max),this.step=Math.round(a),this.slider.previousChange=this.step,this.slider.previousEnd=this.step,this.slider.fireEvent("change",this.step),this.slider.step!==this.step&&(this.slider.step=this.step,this.slider.fireEvent("tick",this.slider.toPosition(this.step))),this}}),ConfigModule=new Class({initialize:function(a){this.moduleName=a},inject:function(a,b,c,d){void 0==d&&(d="after");var e=new Element("li",{id:"l_"+this.moduleName}),f="";f=1==a?'<a id="a_'+this.moduleName+'" href="javascript:;" class="set-item" onclick="gethtml(\''+this.moduleName+'\')">                        <span class="set-item-icon"></span>                        <label class="set-menu-label">'+b+"</label>					</a>":'<a id="a_'+this.moduleName+'" href="javascript:;" data-filename="'+this.moduleName+'" class="J_set_item">'+b+"</a>",e.innerHTML=f,e.inject(c,d),$("a_"+this.moduleName).addEvent("click",function(){clkMenuStyle&&clkMenuStyle(this)})}}),localHash=new Hash;getLocalHash();var Ip=function(){return{compareIpV4:function(a,b){for(var c=a.split("."),d=b.split("."),e=0;e<c.length;e++){var f=c[e]-d[e];if(0!=f)return f}return 0},compareIpv6:function(a,b){var c=compareIPv6(a,b);return 1==c?-1:2==c?1:0},isIpnull:function(a){return a.split(".").some(function(a){return""==a})},getIpValue:function(a){var b=[];a=$(a);var c=a.getAllNext("input");return c.splice(0,0,a),c.each(function(a){b.push(a.value)}),b.join("")?b.join("."):""},setIpValue:function(a,b){a=$(a),b=b||"...";var c=b.split("."),d=a.getAllNext("input");d.splice(0,0,a),d.each(function(a,b){a.value=c[b]})}}}();window.singInterval=function(a,b){var c=(arguments,a._interval||0);return clearInterval(c),a._interval=window.setInterval(function(){a.call(window,a._interval)},b)},String.prototype.lengthB=function(){var a,b,c=0,d=this.length;for(a=d;a--;)b=this.charCodeAt(a),c+=127>=b?1:2047>=b?2:65535>=b?3:4;return c};var RecResize=new Class({Implements:[Events,Options],options:{container:null,max:!1,maxW:0,maxH:0,min:!0,minW:10,minH:10,complete:null},initialize:function(a,b){this.setOptions(b),this.options.max=!!this.options.container,this.options.max&&(this.containerH=this.options.container.getHeight(),this.containerW=this.options.container.getWidth(),this.options.maxW=Math.max(this.options.maxW,this.containerW),this.options.maxH=Math.max(this.options.maxH,this.containerH)),this.target=a,this.style=this._getCurrentStyle(a)},set:function(a,b){var c,d=$(a);if(d){switch(b.toLowerCase()){case"up":c=this._up;break;case"down":c=this._down;break;case"left":c=this._left;break;case"right":c=this._right;break;case"left-up":c=this._leftUp;break;case"right-up":c=this._rightUp;break;case"left-down":c=this._leftDown;break;case"right-down":c=this._rightDown}c&&d.addEvent("mousedown",this._start.bindWithEvent(this,c))}},setTargetOpt:function(a){this.setOptions(a)},_start:function(a,b){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,window.getSelection?window.getSelection().removeAllRanges():document.selection.empty(),this.style=this._getCurrentStyle(this.target),this.start={x:a.client.x,y:a.client.y,w:this.target.clientWidth,h:this.target.clientHeight,top:this.target.offsetTop,left:this.target.offsetLeft},document.addEvents({mousemove:function(a){window.getSelection?window.getSelection().removeAllRanges():document.selection.empty(),b.call(this,a.client.x,a.client.y)}.bind(this),mouseup:this._stop.bind(this)})},_stop:function(){document.removeEvents(),this.options.complete&&this.options.complete.call(this,this.target.getWidth(),this.target.getHeight())},_up:function(a,b){var c=this.start.y-b,d=this.start.h+c;d=this._repairH(d,this.start.h+this.start.top+this.style.borderBottomWidth.toInt()||0),b=this.start.top-(d-this.start.h),this.target.setStyles({top:b,height:d})},_down:function(a,b){var c=b-this.start.y,d=this.start.h+c;d=this._repairH(d,this.containerH-this.start.top-this.style.borderTopWidth.toInt()||0),this.target.setStyles({height:d})},_left:function(a){var b=this.start.x-a,c=this.start.w+b;c=this._repairW(c,this.start.w+this.start.left+this.style.borderRightWidth.toInt()||0),a=this.start.left-(c-this.start.w),this.target.setStyles({left:a,width:c})},_right:function(a){var b=a-this.start.x,c=this.start.w+b;c=this._repairW(c,this.containerW-this.start.left-this.style.borderLeftWidth.toInt()||0),this.target.setStyles({width:c})},_rightUp:function(a,b){this._up(a,b),this._right(a,b)},_leftUp:function(a,b){this._up(a,b),this._left(a,b)},_rightDown:function(a,b){this._right(a,b),this._down(a,b)},_leftDown:function(a,b){this._left(a,b),this._down(a,b)},_repairH:function(a,b){return void 0!=a&&(this.options.max&&(a=Math.min(a,this.options.maxH,b)),this.options.min&&(a=Math.max(a,this.options.minH))),a},_repairW:function(a,b){return void 0!=a&&(this.options.max&&(a=Math.min(a,this.options.maxW,b)),this.options.min&&(a=Math.max(a,this.options.minW))),a},_getCurrentStyle:function(a){return a.currentStyle||document.defaultView.getComputedStyle(a,null)}}),DrawCover=new Class({Implements:[Events,Options],options:{count:4,minWidth:4,minHeight:4,rightClick:!0,sizeChange:null},initialize:function(a,b,c,d){return this.setOptions(d),this.container=a,this.father=this.container.getParent(),this.cvx=this.container.getPosition().x,this.cvy=this.container.getPosition().y,this.w=b,this.h=c,this.offsetL=a.offsetLeft,this.offselT=a.offsetTop,this.seltCover=null,this.coverInd=new Array(this.options.count),this._initCoverInd(),this.$coverQueue=[],this.$creatCover=null,this},fireSizeChange:function(a){this.options.sizeChange=a},setRecOption:function(a,b){var c=this.$coverQueue[a];c&&c.resize.setTargetOpt(b)},startDraw:function(){this.container.addEvent("mousedown",this._down.bind(this))},endDraw:function(){this.container.removeEvent("mousedown"),this.father.removeEvent("mousemove")},completeDraw:function(){},creatCover:function(a,b,c,d,e,f){var g=null;if(isIE9){g=document.createElement("div"),g.setAttribute("id","tstt"+a);var h=10,i=b+"px",j=c+"px",k=d+"px",l=e+"px";g.setAttribute("style","z-index:"+h+";position:absolute;border:1px solid #ffff00;width:"+k+"; top:"+j+";left:"+i+";height:"+l+";background:#373737;-moz-opacity:.5;opacity:.5;filter:alpha(opacity=90);")}else g=new Element("div",{id:"tstt"+a,styles:{"z-index":10,left:b+"px",top:c+"px",width:d+"px",height:e+"px",border:"1px solid #ffff00",position:"absolute"},events:{contextmenu:function(){return!1}}});isIE9?this.father.insertBefore(g,this.container):g.inject(this.container,"after"),this.$coverQueue[a]=g,this._attachCoverEvent(g),this._insertResizeElements(a,g,f),this._removeSelClass(g),this.compareArea(),new Drag.Move(g,{container:this.container})},clearAllCover:function(){for(var a=0;a<this.$coverQueue.length;a++)this.$coverQueue[a].destroy();this.seltCover=null,this._initCoverInd()},compareArea:function(){for(var a=null,b={index:0,minArea:0},c=0;c<this.$coverQueue.length;c++){a=this.$coverQueue[c];var d=(a.getWidth()-2)*(a.getHeight()-2);0==c?b.minArea=d:b.minArea>d&&(b.minArea=d,b.index=c)}for(var c=0;c<this.$coverQueue.length;c++)b.index==c?this.$coverQueue[b.index].setStyle("z-index",20):this.$coverQueue[c].setStyle("z-index",10)},getCoverWH:function(a){var b=this.$coverQueue[a];return[b.getWidth()-2,b.getHeight()-2]},_attachCoverEvent:function(a){var b=this;$(a).addEvent("mousedown",function(a){b.seltCover&&b._removeSelClass(b.seltCover),a=a.event||event,2==a.button&&b.seltCover==this&&b.options.rightClick?(b.coverInd.include(this.id.replace(/[^\d]/g,"")-0),this.destroy(),b.$coverQueue.erase(this),b.seltCover=null):(b.seltCover=this,b._addSelClass(this))})},_initCoverInd:function(){for(var a=0;a<this.options.count;a++)this.coverInd[a]=a},_down:function(a){if(0!=this.coverInd.length){var b=this.coverInd[0],c=a.page.x-this.cvx,d=a.page.y-this.cvy;this.creatCover(b,0,0,0,0),this.$creatCover=this.$coverQueue[b],this.father.addEvent("mousemove",this._fatherMove.bindWithEvent(this,[c,d])),this._mouseup()}},_fatherMove:function(a,b,c){null!=this.seltCover&&this._removeSelClass(this.seltCover);var d=a.page.x-this.cvx,e=a.page.y-this.cvy;d=d.limit(this.offsetL,this.offsetL+this.w),e=e.limit(this.offselT,this.offselT+this.h),this.$creatCover.style.width=Math.max(Math.abs(d-b),4)+"px",this.$creatCover.style.left=Math.min(d,b)+this.offsetL+"px",this.$creatCover.style.height=Math.max(Math.abs(e-c),4)+"px",this.$creatCover.style.top=Math.min(c,e)+this.offselT+"px"},_mouseup:function(){var a=this;document.addEvent("mouseup",function(){a.father.removeEvents("mousemove"),document.removeEvents("mouseup");var b=a.$creatCover;0==parseInt(b.style.height)||0==parseInt(b.style.width)||""==b.style.width||""==b.style.width?(a.coverInd.include(b.id.replace(/[^\d]/g,"")-0),b.destroy()):b&&(a._addSelClass(b),a.seltCover=b,a._attachCoverEvent(a.seltCover),a.compareArea(),a.coverInd.shift(),a.$creatCover=null)})},_insertResizeElements:function(a,b,c){c=c||"";var d='<div id="rLeftUp'+a+'" class="rLeftUp"> </div>			<div id="rUp'+a+'" class="rUp"> </div>			<div id="rRightUp'+a+'" class="rRightUp"> </div>			<div id="rRight'+a+'" class="rRight"> </div>			<div id="rRightDown'+a+'" class="rRightDown"> </div>			<div id="rDown'+a+'" class="rDown"></div>			<div id="rLeftDown'+a+'" class="rLeftDown"> </div>			<div id="rLeft'+a+'" class="rLeft"> </div>      		<div style="color: red;">'+c+"</div>";b.innerHTML=d;var e=this,f=function(a,b){e.compareArea(),e.options.sizeChange&&e.options.sizeChange.call(e,this.target.index,a,b)},g=new RecResize(b,{container:this.container,complete:f});g.set("rUp"+a,"up"),g.set("rRightDown"+a,"right-down"),g.set("rLeftDown"+a,"left-down"),g.set("rRightUp"+a,"right-up"),g.set("rLeftUp"+a,"left-up"),g.set("rRight"+a,"right"),g.set("rLeft"+a,"left"),g.set("rDown"+a,"down"),b.resize=g,b.index=a},_removeSelClass:function(a){a.getChildren("div").setProperty("class","")},_addSelClass:function(a){var b=a.getChildren("div");try{b[0].addClass("rLeftUp"),b[1].addClass("rUp"),b[2].addClass("rRightUp"),b[3].addClass("rRight"),b[4].addClass("rRightDown"),b[5].addClass("rDown"),b[6].addClass("rLeftDown"),b[7].addClass("rLeft")}catch(c){}}});